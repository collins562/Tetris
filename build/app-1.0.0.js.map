{"version":3,"sources":["webpack:///app-1.0.0.js","webpack:///webpack/bootstrap 8fb050d3c9441db5ab91","webpack:///./src/js/main.js","webpack:///./src/js/game/game.js","webpack:///./src/js/game/drawing_board.js","webpack:///./src/js/game/event_controller.js","webpack:///./src/js/utils/event_util.js","webpack:///./src/js/const.js","webpack:///./src/js/utils/function.js","webpack:///./src/js/game/component/clock.js","webpack:///./src/js/game/game_indicator.js","webpack:///./src/js/game/game_board.js","webpack:///./src/js/game/component/pause_sign.js","webpack:///./src/js/game/storage/score.js","webpack:///./src/js/game/game_area.js","webpack:///./src/js/scene/reset/index.js","webpack:///./src/js/game/game_scene.js","webpack:///./src/js/scene/title/index.js","webpack:///./src/js/scene/main/index.js","webpack:///./src/js/scene/main/blockcomb.js","webpack:///./src/js/scene/main/preview.js","webpack:///./src/js/utils/action_controller.js","webpack:///./src/js/view/game_interface.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_game","_game2","_game_interface","_game_interface2","_function","_index","window","onload","isMobile","o","passive","document","documentElement","addEventListener","event","preventDefault","lastTouchEnd","now","Date","gi","new","resize","onresize","instance","game","run","_classCallCheck","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","getter","_drawing_board","_drawing_board2","_event_controller","_event_controller2","_clock","_clock2","_pause_sign","_pause_sign2","_score","_score2","_game_board","_game_board2","_game_area","_game_area2","_index2","Game","_DrawingBoard","callback","this","_this","blockSize","canvas","width","process","callbackRun","getComponent","init","setupEvent","__start","fps","scoreBoard","setTitle","setNumber","clearCountBoard","clock","storage","pauseSign","area","eventCtrler","keyCode","setPauseKeyCode","paused","pause","unpause","controller","registerController","removeAllCallbacks","Scene","name","sceneName","scene","x","y","color","draw","update","_this2","setTimeout","runloop","_this3","replaceScene","DrawingBoard","selectors","querySelector","ctx","getContext","bs","gap","space","offsetX","offsetY","fillStyle","fillRect","clearRect","_len","arguments","args","Array","_key","bind","apply","concat","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","isArray","_event_util","_event_util2","_const","log","console","EventController","_EventUtil","pauseKeyCode","keyBinds","processRawBinds","setup","down","kc","actived","up","buttons","addKBHandler","btnDownState","btnUpState","ism","start","out","end","addMouseHandler","k","keycode","toString","rawBinds","binds","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_step$value","sel","component","sceneControllers","return","sctrls","element","type","state","addHandler","keyboardHandler","isPaused","cpn","ctrl","className","_this4","mouseHandler","e","getTarget","EventUtil","srcElement","returnValue","stopPropagation","cancelBubble","handler","attachEvent","removeEventListener","detachEvent","blockType","btnBindings","pauseState","unpauseState","tikState","tokState","defaultColor","occupiedColor","indicateColor","collide","coors","column","map","coorY","board","occupied","reduce","prev","cond","coorDiff","index","array","max","num","Math","min","ua","navigator","userAgent","android","test","iphone","indexOf","ipod","ipad","nokiaN","_game_indicator","_game_indicator2","Clock","hourBoard","minuteBoard","indicator","hours","getHours","minutes","getMinutes","seconds","getSeconds","setInterval","setState","GameIndicator","GameBoard","eltsSel","titleSel","numElts","querySelectorAll","titleCpn","str","innerText","lastChar","eltClass","n","sum","parseInt","isNaN","r","setDigit","digit","elt","PauseSign","_GameIndicator","count","clearInterval","_typeof","keys","lastRecordKey","maxRecordKey","ScoreStorage","getLocalStorage","localStorage","globalStorage","location","host","warn","val","getRecord","setRecord","GameArea","scoring","row","fullLinesEchoSpeed","fullLinesEchoTimes","line","j","lineIndex","block","scoreFunc","rows","countScore","drawBlock","lines","full","b","cur","score","clearFullLines","li","setLine","ls","forEach","deleted","splice","unshift","echoFullLines","_game_scene","_game_scene2","SceneReset","_GameScene","pushElement","fillArea","clearArea","restartGame","GameScene","elements","_action_controller","_action_controller2","SceneTitle","title","showGap","floor","titleShowGap","titleType","that","registerAction","once","clear","startGame","style","visibility","t","visible","sb","s","getMaxRecord","getLastRecord","_blockcomb","_blockcomb2","SceneMain","eachBlockScore","bc","setUpScoreRule","begin","interval","moveLeft","moveRight","retired","updateCD","rotate","drop","resetGame","sprev","getNumber","ccb","cprev","addScore","maxRecord","lastRecord","setMaxRecord","setLastRecord","occupy","_preview","_preview2","BlockComb","maxUpdateCD","preview","offset","move","newCoors","rotateCoors","sort","c1","c2","updateY","ex","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","isBlocked","retire","Preview","randBlockType","diffX","bt","random","height","events","ActionController","options","clearAll","loop","clearTimeout","GameInterface","root","button","curW","curH","aspectRatio","pageWidth","innerWidth","pageHeight","innerHeight","compatMode","clientWidth","clientHeight","body","g","w","h","size","scale","getBrowserInterfaceSize","negSize","nextW","leftOffset","transform","marginLeft","marginTop"],"mappings":"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","file":"app-1.0.0.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _game = __webpack_require__(1);\n\t\n\tvar _game2 = _interopRequireDefault(_game);\n\t\n\tvar _game_interface = __webpack_require__(20);\n\t\n\tvar _game_interface2 = _interopRequireDefault(_game_interface);\n\t\n\tvar _function = __webpack_require__(6);\n\t\n\tvar _index = __webpack_require__(21);\n\t\n\tvar _index2 = _interopRequireDefault(_index);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\twindow.onload = function () {\n\t    if ((0, _function.isMobile)()) {\n\t        var o = { passive: false\n\t\n\t            // 禁止双指缩放 以及 阻止长按出现菜单\n\t        };document.documentElement.addEventListener('touchstart', function (event) {\n\t            event.preventDefault();\n\t        }, o);\n\t\n\t        // 禁止双击缩放\n\t        var lastTouchEnd = 0;\n\t        document.documentElement.addEventListener('touchend', function (event) {\n\t            var now = Date.now();\n\t            if (now - lastTouchEnd <= 300) {\n\t                event.preventDefault();\n\t            }\n\t            lastTouchEnd = now;\n\t        }, o);\n\t\n\t        // 禁止滚动\n\t        document.documentElement.addEventListener('touchmove', function (event) {\n\t            event.preventDefault();\n\t        }, o);\n\t    }\n\t\n\t    // 调整界面\n\t    var gi = _game_interface2.default.new();\n\t    gi.resize();\n\t    window.onresize = function () {\n\t        gi.resize();\n\t    };\n\t\n\t    // 开始游戏\n\t    var g = _game2.default.instance(function (game) {\n\t        game.run();\n\t    });\n\t};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _drawing_board = __webpack_require__(2);\n\t\n\tvar _drawing_board2 = _interopRequireDefault(_drawing_board);\n\t\n\tvar _event_controller = __webpack_require__(3);\n\t\n\tvar _event_controller2 = _interopRequireDefault(_event_controller);\n\t\n\tvar _clock = __webpack_require__(7);\n\t\n\tvar _clock2 = _interopRequireDefault(_clock);\n\t\n\tvar _pause_sign = __webpack_require__(10);\n\t\n\tvar _pause_sign2 = _interopRequireDefault(_pause_sign);\n\t\n\tvar _score = __webpack_require__(11);\n\t\n\tvar _score2 = _interopRequireDefault(_score);\n\t\n\tvar _game_board = __webpack_require__(9);\n\t\n\tvar _game_board2 = _interopRequireDefault(_game_board);\n\t\n\tvar _game_area = __webpack_require__(12);\n\t\n\tvar _game_area2 = _interopRequireDefault(_game_area);\n\t\n\tvar _index = __webpack_require__(13);\n\t\n\tvar _index2 = _interopRequireDefault(_index);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Game = function (_DrawingBoard) {\n\t    _inherits(Game, _DrawingBoard);\n\t\n\t    function Game(callback) {\n\t        _classCallCheck(this, Game);\n\t\n\t        var _this = _possibleConstructorReturn(this, (Game.__proto__ || Object.getPrototypeOf(Game)).call(this, '#area'));\n\t\n\t        _this.blockSize = _this.canvas.width / 10;\n\t        _this.process = null;\n\t        _this.callbackRun = callback;\n\t\n\t        _this.default();\n\t        _this.getComponent();\n\t        _this.init();\n\t        _this.setupEvent();\n\t        _this.__start();\n\t        return _this;\n\t    }\n\t\n\t    _createClass(Game, [{\n\t        key: 'default',\n\t        value: function _default() {\n\t            this.fps = 30;\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            this.scoreBoard.setTitle('Point');\n\t            this.scoreBoard.setNumber(0);\n\t\n\t            this.clearCountBoard.setNumber(0);\n\t        }\n\t    }, {\n\t        key: 'getComponent',\n\t        value: function getComponent() {\n\t            this.clock = _clock2.default.new();\n\t            this.storage = _score2.default.new();\n\t\n\t            this.scoreBoard = _game_board2.default.new('#point span', '#point p');\n\t            this.clearCountBoard = _game_board2.default.new('#cleans span', '#cleans p');\n\t            this.pauseSign = _pause_sign2.default.new();\n\t\n\t            this.area = _game_area2.default.instance(this);\n\t            this.area.init();\n\t        }\n\t    }, {\n\t        key: 'setupEvent',\n\t        value: function setupEvent() {\n\t            this.eventCtrler = _event_controller2.default.instance(this);\n\t        }\n\t    }, {\n\t        key: 'setPauseKeyCode',\n\t        value: function setPauseKeyCode(keyCode) {\n\t            this.eventCtrler.setPauseKeyCode(keyCode);\n\t        }\n\t    }, {\n\t        key: 'isPaused',\n\t        value: function isPaused() {\n\t            return this.pauseSign.paused;\n\t        }\n\t    }, {\n\t        key: 'pause',\n\t        value: function pause() {\n\t            this.pauseSign.pause();\n\t        }\n\t    }, {\n\t        key: 'unpause',\n\t        value: function unpause() {\n\t            this.pauseSign.unpause();\n\t        }\n\t    }, {\n\t        key: 'registerAction',\n\t        value: function registerAction(keyCode, controller) {\n\t            this.eventCtrler.registerController(keyCode, controller);\n\t        }\n\t    }, {\n\t        key: 'removeAllActions',\n\t        value: function removeAllActions() {\n\t            this.eventCtrler.removeAllCallbacks();\n\t        }\n\t    }, {\n\t        key: 'replaceScene',\n\t        value: function replaceScene(Scene, name) {\n\t            // cancel the registered functions\n\t            // this.removeAllActions()\n\t            this.sceneName = name;\n\t            this.scene = Scene.new(this);\n\t            // Scene.new will:\n\t            //      1st: create a singular instance at the first time or\n\t            //      2nd: just initialize the instance\n\t            this.eventCtrler.init();\n\t        }\n\t    }, {\n\t        key: 'drawBlock',\n\t        value: function drawBlock(x, y, color) {\n\t            _get(Game.prototype.__proto__ || Object.getPrototypeOf(Game.prototype), 'drawBlock', this).call(this, x, y, this.blockSize, color);\n\t        }\n\t    }, {\n\t        key: 'draw',\n\t        value: function draw() {\n\t            this.scene.draw();\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            this.scene.update();\n\t        }\n\t    }, {\n\t        key: 'runloop',\n\t        value: function runloop() {\n\t            var _this2 = this;\n\t\n\t            //this.clear()\n\t            this.draw();\n\t            this.update();\n\t            this.process = setTimeout(function () {\n\t                _this2.runloop();\n\t            }, 1000 / this.fps);\n\t        }\n\t    }, {\n\t        key: 'run',\n\t        value: function run() {\n\t            var _this3 = this;\n\t\n\t            this.process = setTimeout(function () {\n\t                _this3.runloop();\n\t            }, 1000 / this.fps);\n\t        }\n\t    }, {\n\t        key: '__start',\n\t        value: function __start() {\n\t            this.replaceScene(_index2.default);\n\t            this.callbackRun(this);\n\t        }\n\t    }]);\n\t\n\t    return Game;\n\t}(_drawing_board2.default);\n\t\n\texports.default = Game;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DrawingBoard = function () {\n\t    function DrawingBoard(selectors) {\n\t        _classCallCheck(this, DrawingBoard);\n\t\n\t        this.canvas = document.querySelector(selectors);\n\t        this.ctx = this.canvas.getContext('2d');\n\t    }\n\t\n\t    _createClass(DrawingBoard, [{\n\t        key: 'drawBlock',\n\t        value: function drawBlock(x, y, bs, color) {\n\t            var gap, space, ctx, length, offsetX, offsetY;\n\t            gap = bs / 15;\n\t            space = bs / 10;\n\t            ctx = this.ctx;\n\t\n\t            ctx.fillStyle = color;\n\t            // 画外框\n\t            offsetX = bs * x + gap;\n\t            offsetY = bs * y + gap;\n\t            length = bs - 2 * gap;\n\t            ctx.fillRect(offsetX, offsetY, length, length);\n\t\n\t            // 请空间隔\n\t            offsetX += gap;\n\t            offsetY += gap;\n\t            length -= 2 * gap;\n\t            ctx.clearRect(offsetX, offsetY, length, length);\n\t\n\t            // 画正中间方块\n\t            length -= space * 2;\n\t            ctx.fillRect(offsetX + space, offsetY + space, length, length);\n\t        }\n\t    }], [{\n\t        key: 'instance',\n\t        value: function instance() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            this.i = this.i || new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t            return this.i;\n\t        }\n\t    }]);\n\t\n\t    return DrawingBoard;\n\t}();\n\t\n\texports.default = DrawingBoard;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _event_util = __webpack_require__(4);\n\t\n\tvar _event_util2 = _interopRequireDefault(_event_util);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tvar _function = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar log = console.log.bind();\n\t\n\tvar EventController = function (_EventUtil) {\n\t    _inherits(EventController, _EventUtil);\n\t\n\t    function EventController(game) {\n\t        _classCallCheck(this, EventController);\n\t\n\t        var _this = _possibleConstructorReturn(this, (EventController.__proto__ || Object.getPrototypeOf(EventController)).call(this));\n\t\n\t        _this.game = game;\n\t        // pauseKeyCode : a special key to unauthorize the use of all the other keys\n\t        _this.pauseKeyCode = null;\n\t        /* keyBinds     : will has attritutes as follows\r\n\t                {\r\n\t                    sceneControllers: { \r\n\t                        sceneName1 : controller1,\r\n\t                        sceneName2 : controller2,\r\n\t                        ... \r\n\t                    },\r\n\t                    component: component,\r\n\t                    actived: true or false,\r\n\t                }\r\n\t        */\n\t        _this.keyBinds = {};\n\t\n\t        _this.processRawBinds();\n\t        _this.setup();\n\t        return _this;\n\t    }\n\t\n\t    _createClass(EventController, [{\n\t        key: 'setup',\n\t        value: function setup() {\n\t            var _this2 = this;\n\t\n\t            // 通过 actived 确保按住键盘不放时，绑定的事件只会触发一次\n\t            var down = function down(kc, controller) {\n\t                if (!_this2.keyBinds[kc].actived) {\n\t                    controller.down();\n\t                    _this2.keyBinds[kc].actived = true;\n\t                }\n\t            };\n\t            var up = function up(kc, controller) {\n\t                _this2.keyBinds[kc].actived = false;\n\t                controller.up();\n\t            };\n\t            var buttons = document.querySelector('#button');\n\t            this.addKBHandler(window, 'keydown', _const.btnDownState, down);\n\t            this.addKBHandler(window, 'keyup', _const.btnUpState, up);\n\t\n\t            var ism = (0, _function.isMobile)();\n\t            var start = ism ? 'touchstart' : 'mousedown';\n\t            var out = 'mouseout';\n\t            var end = ism ? 'touchend' : 'mouseup';\n\t            this.addMouseHandler(buttons, start, _const.btnDownState, down);\n\t            this.addMouseHandler(buttons, end, _const.btnUpState, up);\n\t            this.addMouseHandler(buttons, out, _const.btnUpState, up);\n\t            // 当 user 没有在按钮里面结束鼠标事件时，如果是不会触发 mouseup 事件的\n\t            // 只有用 mouseout 才能保证按键能正常结束，恢复原来的按键状况\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            for (var k in this.keyBinds) {\n\t                if (this.keyBinds[k]) {\n\t                    this.keyBinds[k].actived = false;\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'setPauseKeyCode',\n\t        value: function setPauseKeyCode(keycode) {\n\t            this.pauseKeyCode = keycode.toString();\n\t        }\n\t\n\t        // 处理设置好的 bindings 得到 keyCodes 对应的元素\n\t\n\t    }, {\n\t        key: 'processRawBinds',\n\t        value: function processRawBinds() {\n\t            var rawBinds = _const.btnBindings;\n\t            var binds = {};\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = rawBinds[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var _step$value = _slicedToArray(_step.value, 2),\n\t                        keyCode = _step$value[0],\n\t                        sel = _step$value[1];\n\t\n\t                    binds[keyCode] = {\n\t                        component: document.querySelector(sel),\n\t                        sceneControllers: {},\n\t                        actived: false\n\t                    };\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t\n\t            this.keyBinds = binds;\n\t        }\n\t\n\t        // 根据当前的 game.sceneName 来设置 controller (EventController 实例)\n\t\n\t    }, {\n\t        key: 'registerController',\n\t        value: function registerController(keyCode, controller) {\n\t            var binds = this.keyBinds[keyCode];\n\t            var sceneName = this.game.sceneName;\n\t\n\t            if (!binds) {\n\t                binds = this.keyBinds[keyCode] = {\n\t                    sceneControllers: {},\n\t                    actived: false\n\t                };\n\t            }\n\t            var sctrls = binds.sceneControllers;\n\t            sctrls[sceneName] = controller;\n\t        }\n\t\n\t        // 对 keybinds 里的对象添加键盘事件\n\t\n\t    }, {\n\t        key: 'addKBHandler',\n\t        value: function addKBHandler(element, type, state, callback) {\n\t            var _this3 = this;\n\t\n\t            log('add', type, 'handler of btns to', element.toString());\n\t            var game = this.game;\n\t            this.addHandler(element, type, function (event) {\n\t                _this3.keyboardHandler(event, state, callback);\n\t            });\n\t        }\n\t    }, {\n\t        key: 'keyboardHandler',\n\t        value: function keyboardHandler(event, state, callback) {\n\t            var kc = event.keyCode;\n\t            var game = this.game;\n\t            if (kc in this.keyBinds) {\n\t                var bind = this.keyBinds[kc];\n\t                var paused = game.isPaused();\n\t                var cpn = bind.component;\n\t                var ctrl = bind.sceneControllers[game.sceneName]; // 得到当前场景对应的注册controller\n\t                if (cpn) {\n\t                    // 更新组件的状态\n\t                    cpn.className = state;\n\t                }\n\t                if (!(paused && kc != this.pauseKeyCode) && ctrl) {\n\t                    callback(kc, ctrl);\n\t                }\n\t            }\n\t        }\n\t\n\t        // 对 keybinds 里的对象添加鼠标事件\n\t\n\t    }, {\n\t        key: 'addMouseHandler',\n\t        value: function addMouseHandler(element, type, state, callback) {\n\t            var _this4 = this;\n\t\n\t            log('add', type, 'handler of btns to btns');\n\t            this.addHandler(window, type, function (event) {\n\t                _this4.mouseHandler(event, state, callback);\n\t            });\n\t        }\n\t    }, {\n\t        key: 'mouseHandler',\n\t        value: function mouseHandler(event, state, callback) {\n\t            var e = this.getTarget(event);\n\t            var paused = this.game.isPaused();\n\t            for (var kc in this.keyBinds) {\n\t                var bind = this.keyBinds[kc];\n\t                var cpn = bind.component;\n\t                var ctrl = bind.sceneControllers[this.game.sceneName];\n\t                if (cpn !== e) {\n\t                    continue;\n\t                }\n\t\n\t                cpn.className = state;\n\t                if (!(paused && kc !== this.pauseKeyCode) && ctrl) {\n\t                    return callback(kc, ctrl);\n\t                }\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return EventController;\n\t}(_event_util2.default);\n\t\n\texports.default = EventController;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar EventUtil = function () {\n\t    function EventUtil() {\n\t        _classCallCheck(this, EventUtil);\n\t    }\n\t\n\t    _createClass(EventUtil, [{\n\t        key: 'getEvent',\n\t        value: function getEvent() {\n\t            return event ? event : window.event;\n\t        }\n\t    }, {\n\t        key: 'getTarget',\n\t        value: function getTarget(event) {\n\t            return event.target || event.srcElement;\n\t        }\n\t    }, {\n\t        key: 'preventDefault',\n\t        value: function preventDefault(event) {\n\t            if (event.preventDefault) {\n\t                event.preventDefault();\n\t            } else {\n\t                event.returnValue = false;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'stopPropagation',\n\t        value: function stopPropagation(event) {\n\t            if (event.stopPropagation) {\n\t                event.stopPropagation();\n\t            } else {\n\t                event.cancelBubble = true;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'addHandler',\n\t        value: function addHandler(element, type, handler) {\n\t            if (element.addEventListener) {\n\t                element.addEventListener(type, handler);\n\t            } else if (element.attachEvent) {\n\t                element.attachEvent('on' + type, handler);\n\t            } else {\n\t                element['on' + type] = handler;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'removeHandler',\n\t        value: function removeHandler(element, type, handler) {\n\t            if (element.removeEventListener) {\n\t                element.removeEventListener(type, handler);\n\t            } else if (element.detachEvent) {\n\t                element.detachEvent('on' + type, handler);\n\t            } else {\n\t                element['on' + type] = handler;\n\t            }\n\t        }\n\t    }], [{\n\t        key: 'instance',\n\t        value: function instance() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            this.i = this.i || new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t            return this.i;\n\t        }\n\t    }]);\n\t\n\t    return EventUtil;\n\t}();\n\t\n\texports.default = EventUtil;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar blockType = [[[0, 0], [1, 0], [2, 0], [3, 0]], [[0, 0], [0, 1], [1, 0], [1, 1]], [[0, 1], [1, 0], [1, 1], [2, 1]], [[0, 0], [0, 1], [1, 1], [2, 1]], [[0, 1], [1, 1], [2, 0], [2, 1]], [[0, 0], [1, 0], [1, 1], [2, 1]], [[0, 1], [1, 0], [1, 1], [2, 0]]];\n\t\n\t// button_bindings : contains [keyCode, sel] pairs\n\t// sel             : the id of related button\n\tvar btnBindings = [[38, '#rotate_btn'], // arrow up\n\t[40, '#down_btn'], // arrow down\n\t[37, '#left_btn'], // arrow left\n\t[39, '#right_btn'], // arrow right\n\t[32, '#drop_btn'], // space\n\t[80, '#pause_btn'], // p\n\t[82, '#reset_btn']];\n\t\n\tvar btnDownState = 'pressed';\n\tvar btnUpState = '';\n\t\n\tvar pauseState = 'paused';\n\tvar unpauseState = 'unpaused';\n\t\n\tvar tikState = 'tik';\n\tvar tokState = 'tok';\n\t\n\tvar defaultColor = 'rgb(135, 147, 100)'; // 方块没有被占据时的颜色\n\tvar occupiedColor = 'rgb(0, 0, 0)'; // 方块被占据时的颜色\n\tvar indicateColor = 'rgb(180, 0, 0)'; // 高亮显示方块时的颜色\n\t\n\texports.blockType = blockType;\n\texports.btnBindings = btnBindings;\n\texports.btnDownState = btnDownState;\n\texports.btnUpState = btnUpState;\n\texports.pauseState = pauseState;\n\texports.unpauseState = unpauseState;\n\texports.tikState = tikState;\n\texports.tokState = tokState;\n\texports.defaultColor = defaultColor;\n\texports.occupiedColor = occupiedColor;\n\texports.indicateColor = indicateColor;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar collide = function collide(x, y, coors, area) {\n\t    if (x < 0 || x + coors[3][0] >= area.column) {\n\t        return true;\n\t    }\n\t\n\t    return coors.map(function (c) {\n\t        // y + c[1] < 0 means the block is above the field\n\t        // so literally it dosen't collides\n\t        var coorY = y + c[1];\n\t        return !(coorY < 0 || !area.board[coorY][x + c[0]].occupied);\n\t    }).reduce(function (prev, cond) {\n\t        return prev || cond;\n\t    });\n\t};\n\t\n\tvar coorDiff = function coorDiff(coors, index) {\n\t    var array = coors.map(function (c) {\n\t        return c[index];\n\t    });\n\t    return array.reduce(function (max, num) {\n\t        return Math.max(max, num);\n\t    }) - array.reduce(function (min, num) {\n\t        return Math.min(min, num);\n\t    });\n\t};\n\t\n\tvar isMobile = function isMobile() {\n\t    // 判断是否为移动端\n\t    var ua = navigator.userAgent;\n\t    var android = /Android (\\d+\\.\\d+)/.test(ua);\n\t    var iphone = ua.indexOf('iPhone') > -1;\n\t    var ipod = ua.indexOf('iPod') > -1;\n\t    var ipad = ua.indexOf('iPad') > -1;\n\t    var nokiaN = ua.indexOf('NokiaN') > -1;\n\t    return android || iphone || ipod || ipad || nokiaN;\n\t};\n\t\n\texports.collide = collide;\n\texports.coorDiff = coorDiff;\n\texports.isMobile = isMobile;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _game_indicator = __webpack_require__(8);\n\t\n\tvar _game_indicator2 = _interopRequireDefault(_game_indicator);\n\t\n\tvar _game_board = __webpack_require__(9);\n\t\n\tvar _game_board2 = _interopRequireDefault(_game_board);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Clock = function () {\n\t    function Clock(game) {\n\t        _classCallCheck(this, Clock);\n\t\n\t        this.game = game;\n\t        this.setup();\n\t    }\n\t\n\t    _createClass(Clock, [{\n\t        key: 'setup',\n\t        value: function setup() {\n\t            var _this = this;\n\t\n\t            this.hourBoard = _game_board2.default.new('#s_hour span');\n\t            this.minuteBoard = _game_board2.default.new('#s_minute span');\n\t            this.indicator = _game_indicator2.default.new('#s_clock_indi');\n\t\n\t            var now = new Date();\n\t            this.hours = now.getHours();\n\t            this.minutes = now.getMinutes();\n\t            this.seconds = now.getSeconds();\n\t\n\t            this.hourBoard.setNumber(this.hours);\n\t            this.minuteBoard.setNumber(this.minutes);\n\t\n\t            setInterval(function () {\n\t                _this.update();\n\t            }, 1000);\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            if (++this.seconds == 60) {\n\t                this.seconds = 0;\n\t                if (++this.minutes == 60) {\n\t                    this.minutes = 0;\n\t                    if (++this.hours == 24) {\n\t                        this.hours = 0;\n\t                    }\n\t                    this.hourBoard.setNumber(this.hours);\n\t                }\n\t                this.minuteBoard.setNumber(this.minutes);\n\t            }\n\t\n\t            var state = this.seconds % 2 == 0 ? _const.tikState : _const.tokState;\n\t            this.indicator.setState(state);\n\t        }\n\t    }], [{\n\t        key: 'new',\n\t        value: function _new() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            return new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t        }\n\t    }]);\n\t\n\t    return Clock;\n\t}();\n\t\n\texports.default = Clock;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GameIndicator = function () {\n\t    // 用来管理 状态指示器\n\t    function GameIndicator(sel) {\n\t        _classCallCheck(this, GameIndicator);\n\t\n\t        this.component = document.querySelector(sel);\n\t    }\n\t\n\t    _createClass(GameIndicator, [{\n\t        key: \"setState\",\n\t        value: function setState(state) {\n\t            this.component.className = state;\n\t        }\n\t    }], [{\n\t        key: \"new\",\n\t        value: function _new() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            return new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t        }\n\t    }]);\n\t\n\t    return GameIndicator;\n\t}();\n\t\n\texports.default = GameIndicator;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GameBoard = function () {\n\t    // Board 用来管理跟数字有关的 elements\n\t    function GameBoard(eltsSel, titleSel) {\n\t        _classCallCheck(this, GameBoard);\n\t\n\t        this.numElts = document.querySelectorAll(eltsSel);\n\t        if (titleSel) {\n\t            this.titleCpn = document.querySelector(titleSel);\n\t        }\n\t    }\n\t\n\t    _createClass(GameBoard, [{\n\t        key: 'setTitle',\n\t        value: function setTitle(str) {\n\t            this.titleCpn.innerText = str;\n\t        }\n\t\n\t        // 通过判断元素的样式来计算所显示的数字的大小\n\t\n\t    }, {\n\t        key: 'getNumber',\n\t        value: function getNumber() {\n\t            var lastChar,\n\t                eltClass,\n\t                n,\n\t                sum = 0;\n\t            for (var i = this.numElts.length - 1; i >= 0; i--) {\n\t                eltClass = this.numElts[i].className;\n\t                lastChar = eltClass == '' ? 0 : eltClass[eltClass.length - 1];\n\t                n = parseInt(lastChar);\n\t                if (!isNaN(n)) {\n\t                    sum = 10 * sum + n;\n\t                }\n\t            }\n\t            return sum;\n\t        }\n\t\n\t        // 通过改变元素的样式来改变显示的数字\n\t\n\t    }, {\n\t        key: 'setNumber',\n\t        value: function setNumber(num) {\n\t            var r,\n\t                length = this.numElts.length;\n\t            for (var i = 0; i < length && num > 0; i++) {\n\t                r = num % 10;\n\t                this.setDigit(r, this.numElts[i]);\n\t                num = (num - r) / 10;\n\t            }\n\t\n\t            if (i == 0) {\n\t                this.setDigit(0, this.numElts[0]);\n\t                i++;\n\t            }\n\t            for (; i < length; i++) {\n\t                this.setDigit(null, this.numElts[i]);\n\t            }\n\t        }\n\t\n\t        // digit 为 null 时清除状态\n\t        // 否则就设置与 digit 相对应的数字状态\n\t\n\t    }, {\n\t        key: 'setDigit',\n\t        value: function setDigit(digit, elt) {\n\t            elt.className = digit == null ? '' : 'n' + digit;\n\t        }\n\t    }], [{\n\t        key: 'new',\n\t        value: function _new() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            return new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t        }\n\t    }]);\n\t\n\t    return GameBoard;\n\t}();\n\t\n\texports.default = GameBoard;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _game_indicator = __webpack_require__(8);\n\t\n\tvar _game_indicator2 = _interopRequireDefault(_game_indicator);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar PauseSign = function (_GameIndicator) {\n\t    _inherits(PauseSign, _GameIndicator);\n\t\n\t    // 用来管理 暂停功能 以及 在游戏界面中的暂停标志\n\t    function PauseSign() {\n\t        _classCallCheck(this, PauseSign);\n\t\n\t        var _this = _possibleConstructorReturn(this, (PauseSign.__proto__ || Object.getPrototypeOf(PauseSign)).call(this, '#s_psign'));\n\t\n\t        _this.process = null;\n\t        _this.paused = false;\n\t        _this.count = 0;\n\t        return _this;\n\t    }\n\t\n\t    _createClass(PauseSign, [{\n\t        key: 'pause',\n\t        value: function pause() {\n\t            var _this2 = this;\n\t\n\t            this.paused = true;\n\t            this.process = setInterval(function () {\n\t                _this2.count++ % 2 == 0 ? _this2.setState(_const.pauseState) : _this2.setState(_const.unpauseState);\n\t            }, 1000 / 4);\n\t        }\n\t    }, {\n\t        key: 'unpause',\n\t        value: function unpause() {\n\t            this.paused = false;\n\t            this.count = 0;\n\t            this.setState(_const.unpauseState);\n\t            clearInterval(this.process);\n\t        }\n\t    }]);\n\t\n\t    return PauseSign;\n\t}(_game_indicator2.default);\n\t\n\texports.default = PauseSign;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar keys = {\n\t    lastRecordKey: \"tetris-last-record\",\n\t    maxRecordKey: \"tetris-max-record\"\n\t};\n\t\n\tvar ScoreStorage = function () {\n\t    function ScoreStorage() {\n\t        _classCallCheck(this, ScoreStorage);\n\t\n\t        this.storage = this.getLocalStorage();\n\t    }\n\t\n\t    _createClass(ScoreStorage, [{\n\t        key: \"getLocalStorage\",\n\t        value: function getLocalStorage() {\n\t            if ((typeof localStorage === \"undefined\" ? \"undefined\" : _typeof(localStorage)) == 'object') {\n\t                return localStorage;\n\t            } else if ((typeof globalStorage === \"undefined\" ? \"undefined\" : _typeof(globalStorage)) == 'object') {\n\t                return globalStorage[location.host];\n\t            } else {\n\t                console.warn('Local storage not available. Your record will be forgetted after leave');\n\t                return {};\n\t            }\n\t        }\n\t    }, {\n\t        key: \"getRecord\",\n\t        value: function getRecord(key) {\n\t            var num = parseInt(this.storage[key]);\n\t            return isNaN(num) ? 0 : num;\n\t        }\n\t    }, {\n\t        key: \"setRecord\",\n\t        value: function setRecord(key, val) {\n\t            this.storage[key] = val;\n\t        }\n\t    }, {\n\t        key: \"getLastRecord\",\n\t        value: function getLastRecord() {\n\t            return this.getRecord(keys.lastRecordKey);\n\t        }\n\t    }, {\n\t        key: \"setLastRecord\",\n\t        value: function setLastRecord(num) {\n\t            this.setRecord(keys.lastRecordKey, num);\n\t        }\n\t    }, {\n\t        key: \"getMaxRecord\",\n\t        value: function getMaxRecord() {\n\t            return this.getRecord(keys.maxRecordKey);\n\t        }\n\t    }, {\n\t        key: \"setMaxRecord\",\n\t        value: function setMaxRecord(num) {\n\t            this.setRecord(keys.maxRecordKey, num);\n\t        }\n\t    }], [{\n\t        key: \"new\",\n\t        value: function _new() {\n\t            return new this();\n\t        }\n\t    }]);\n\t\n\t    return ScoreStorage;\n\t}();\n\t\n\texports.default = ScoreStorage;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GameArea = function () {\n\t    function GameArea(game) {\n\t        _classCallCheck(this, GameArea);\n\t\n\t        this.game = game;\n\t        this.board = [];\n\t        this.scoring = false;\n\t        this.process = null;\n\t        this.count = 0;\n\t        this.default();\n\t    }\n\t\n\t    _createClass(GameArea, [{\n\t        key: 'default',\n\t        value: function _default() {\n\t            this.row = 20;\n\t            this.column = 10;\n\t            this.defaultColor = _const.defaultColor;\n\t            this.indicateColor = _const.indicateColor;\n\t            this.fullLinesEchoSpeed = 15; // board 中的满行显示的速度\n\t            this.fullLinesEchoTimes = 3; // 重复显示 board 中满行的次数\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            for (var i = 0; i < this.row; i++) {\n\t                this.board[i] = [];\n\t                var line = this.board[i];\n\t                for (var j = 0; j < this.column; j++) {\n\t                    line[j] = {\n\t                        color: this.defaultColor,\n\t                        occupied: false\n\t                    };\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'setLine',\n\t        value: function setLine(lineIndex, color, occupied) {\n\t            var line = this.board[lineIndex];\n\t            for (var i = 0; i < this.column; i++) {\n\t                var block = line[i];\n\t                block.color = color;\n\t                block.occupied = occupied;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'setUpScoreRule',\n\t        value: function setUpScoreRule(scene) {\n\t            this.scoreFunc = function (rows) {\n\t                scene.countScore(rows);\n\t            };\n\t        }\n\t    }, {\n\t        key: 'draw',\n\t        value: function draw() {\n\t            var game = this.game;\n\t            for (var i = 0; i < this.row; i++) {\n\t                for (var j = 0; j < this.column; j++) {\n\t                    game.drawBlock(j, i, this.board[i][j].color);\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            var lines = [];\n\t            for (var i = 0; i < this.row; i++) {\n\t                var full = this.board[i].map(function (b) {\n\t                    return b.occupied;\n\t                }).reduce(function (prev, cur) {\n\t                    return prev && cur;\n\t                });\n\t\n\t                if (full) {\n\t                    lines.push(i);\n\t                }\n\t            }\n\t\n\t            if (lines.length > 0) {\n\t                this.scoring = true;\n\t                this.lines = lines;\n\t                this.score();\n\t            }\n\t        }\n\t\n\t        // 通过更新 full lines 的颜色来高亮显示 full lines\n\t\n\t    }, {\n\t        key: 'echoFullLines',\n\t        value: function echoFullLines() {\n\t            var _this = this;\n\t\n\t            // 游戏暂停时不更新\n\t            if (this.game.isPaused()) {\n\t                return;\n\t            }\n\t\n\t            if (this.count++ > this.fullLinesEchoTimes * 2 - 1) {\n\t                this.count = 0;\n\t                this.scoring = false;\n\t                clearInterval(this.process);\n\t                this.clearFullLines();\n\t                return;\n\t            }\n\t            var color = this.count % 2 == 0 ? this.defaultColor : this.indicateColor;\n\t            this.lines.map(function (li) {\n\t                _this.setLine(li, color, false);\n\t            });\n\t        }\n\t\n\t        // 在 echoFullLines() 中 full lines 的颜色已设置成\n\t        // defaultColor 因此直接将它移到数组顶部\n\t\n\t    }, {\n\t        key: 'clearFullLines',\n\t        value: function clearFullLines() {\n\t            var _this2 = this;\n\t\n\t            var ls = this.lines;\n\t            ls.forEach(function (li) {\n\t                var deleted = _this2.board.splice(li, 1)[0];\n\t                _this2.board.unshift(deleted);\n\t            });\n\t            this.scoreFunc(ls.length);\n\t            this.lines = null;\n\t        }\n\t    }, {\n\t        key: 'score',\n\t        value: function score() {\n\t            var _this3 = this;\n\t\n\t            this.scoring = true;\n\t            this.process = setInterval(function () {\n\t                _this3.echoFullLines();\n\t            }, 1000 / this.fullLinesEchoSpeed);\n\t        }\n\t    }], [{\n\t        key: 'instance',\n\t        value: function instance(game) {\n\t            this.i = this.i || new this(game);\n\t            return this.i;\n\t        }\n\t    }]);\n\t\n\t    return GameArea;\n\t}();\n\t\n\texports.default = GameArea;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _game_scene = __webpack_require__(14);\n\t\n\tvar _game_scene2 = _interopRequireDefault(_game_scene);\n\t\n\tvar _index = __webpack_require__(15);\n\t\n\tvar _index2 = _interopRequireDefault(_index);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SceneReset = function (_GameScene) {\n\t    _inherits(SceneReset, _GameScene);\n\t\n\t    function SceneReset(game) {\n\t        _classCallCheck(this, SceneReset);\n\t\n\t        return _possibleConstructorReturn(this, (SceneReset.__proto__ || Object.getPrototypeOf(SceneReset)).call(this, game));\n\t    }\n\t\n\t    _createClass(SceneReset, [{\n\t        key: 'setup',\n\t        value: function setup() {\n\t            this.pushElement(this.game.area);\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            this.index = 19;\n\t            this.update = this.fillArea;\n\t        }\n\t    }, {\n\t        key: 'fillArea',\n\t        value: function fillArea() {\n\t            var area = this.game.area;\n\t            area.setLine(this.index, _const.occupiedColor, false);\n\t            if (--this.index < 0) {\n\t                this.index = 0;\n\t                this.update = this.clearArea;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'clearArea',\n\t        value: function clearArea() {\n\t            var area = this.game.area;\n\t            area.setLine(this.index, _const.defaultColor, false);\n\t            if (++this.index == 20) {\n\t                this.restartGame();\n\t            }\n\t        }\n\t    }, {\n\t        key: 'restartGame',\n\t        value: function restartGame() {\n\t            this.game.replaceScene(_index2.default, 'title');\n\t        }\n\t    }]);\n\t\n\t    return SceneReset;\n\t}(_game_scene2.default);\n\t\n\texports.default = SceneReset;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GameScene = function () {\n\t    function GameScene(game) {\n\t        _classCallCheck(this, GameScene);\n\t\n\t        this.game = game;\n\t        this.elements = [];\n\t        this.setup();\n\t    }\n\t\n\t    _createClass(GameScene, [{\n\t        key: \"setup\",\n\t        value: function setup() {}\n\t    }, {\n\t        key: \"init\",\n\t        value: function init() {}\n\t    }, {\n\t        key: \"draw\",\n\t        value: function draw() {\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = this.elements[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var e = _step.value;\n\t\n\t                    e.draw();\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: \"update\",\n\t        value: function update() {}\n\t    }, {\n\t        key: \"pushElement\",\n\t        value: function pushElement(elt) {\n\t            this.elements.push(elt);\n\t        }\n\t    }], [{\n\t        key: \"new\",\n\t        value: function _new(game) {\n\t            this.i = this.i || new this(game);\n\t            this.i.init();\n\t            return this.i;\n\t        }\n\t    }]);\n\t\n\t    return GameScene;\n\t}();\n\t\n\texports.default = GameScene;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _game_scene = __webpack_require__(14);\n\t\n\tvar _game_scene2 = _interopRequireDefault(_game_scene);\n\t\n\tvar _index = __webpack_require__(16);\n\t\n\tvar _index2 = _interopRequireDefault(_index);\n\t\n\tvar _action_controller = __webpack_require__(19);\n\t\n\tvar _action_controller2 = _interopRequireDefault(_action_controller);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SceneTitle = function (_GameScene) {\n\t    _inherits(SceneTitle, _GameScene);\n\t\n\t    function SceneTitle(game) {\n\t        _classCallCheck(this, SceneTitle);\n\t\n\t        var _this = _possibleConstructorReturn(this, (SceneTitle.__proto__ || Object.getPrototypeOf(SceneTitle)).call(this, game));\n\t\n\t        _this.title = document.querySelector('#title');\n\t        _this.showGap = Math.floor(game.fps * 0.75);\n\t        _this.titleShowGap = game.fps * 2;\n\t        _this.count = 0;\n\t        _this.titleType = 1;\n\t        return _this;\n\t    }\n\t\n\t    _createClass(SceneTitle, [{\n\t        key: 'setup',\n\t        value: function setup() {\n\t            var game = this.game;\n\t            var that = this;\n\t\n\t            // 按 空格 开始游戏\n\t            game.registerAction(32, _action_controller2.default.new({\n\t                key: 'space',\n\t                once: true,\n\t                callback: function callback(clear) {\n\t                    that.startGame();\n\t                }\n\t            }));\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            var game = this.game;\n\t\n\t            game.area.draw();\n\t        }\n\t    }, {\n\t        key: 'startGame',\n\t        value: function startGame() {\n\t            var game = this.game;\n\t            game.replaceScene(_index2.default, 'main');\n\t            game.init();\n\t            this.title.style.visibility = 'hidden';\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            var t = this.title;\n\t            var game = this.game;\n\t            if (this.count % this.showGap == 0) {\n\t                var visible = t.style.visibility == 'visible';\n\t                t.style.visibility = visible ? 'hidden' : 'visible';\n\t            }\n\t            if (this.count % this.titleShowGap == 0) {\n\t                var sb = game.scoreBoard;\n\t                var s = game.storage;\n\t                if (this.titleType) {\n\t                    sb.setTitle('Max');\n\t                    sb.setNumber(s.getMaxRecord());\n\t                } else {\n\t                    sb.setTitle('Last Round');\n\t                    sb.setNumber(s.getLastRecord());\n\t                }\n\t                this.titleType = !this.titleType;\n\t            }\n\t            this.count++;\n\t        }\n\t    }]);\n\t\n\t    return SceneTitle;\n\t}(_game_scene2.default);\n\t\n\texports.default = SceneTitle;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _game_scene = __webpack_require__(14);\n\t\n\tvar _game_scene2 = _interopRequireDefault(_game_scene);\n\t\n\tvar _blockcomb = __webpack_require__(17);\n\t\n\tvar _blockcomb2 = _interopRequireDefault(_blockcomb);\n\t\n\tvar _index = __webpack_require__(13);\n\t\n\tvar _index2 = _interopRequireDefault(_index);\n\t\n\tvar _action_controller = __webpack_require__(19);\n\t\n\tvar _action_controller2 = _interopRequireDefault(_action_controller);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SceneMain = function (_GameScene) {\n\t    _inherits(SceneMain, _GameScene);\n\t\n\t    function SceneMain(game) {\n\t        _classCallCheck(this, SceneMain);\n\t\n\t        return _possibleConstructorReturn(this, (SceneMain.__proto__ || Object.getPrototypeOf(SceneMain)).call(this, game));\n\t    }\n\t\n\t    _createClass(SceneMain, [{\n\t        key: 'setup',\n\t        value: function setup() {\n\t            var that = this;\n\t            var game = this.game;\n\t            var area = game.area;\n\t\n\t            this.eachBlockScore = 10;\n\t\n\t            this.bc = _blockcomb2.default.instance(game);\n\t            this.pushElement(area);\n\t            this.pushElement(this.bc);\n\t\n\t            area.setUpScoreRule(this);\n\t\n\t            // 按 '向左箭头' 左移\n\t            game.registerAction(37, _action_controller2.default.new({\n\t                key: 'left',\n\t                begin: 200,\n\t                interval: 100,\n\t                callback: function callback(clear) {\n\t                    that.bc.moveLeft();\n\t                }\n\t            }));\n\t\n\t            // 按 '向右箭头' 右移\n\t            game.registerAction(39, _action_controller2.default.new({\n\t                key: 'right',\n\t                begin: 200,\n\t                interval: 100,\n\t                callback: function callback(clear) {\n\t                    that.bc.moveRight();\n\t                }\n\t            }));\n\t\n\t            // 按 '向下箭头' 加速\n\t            game.registerAction(40, _action_controller2.default.new({\n\t                key: 'down',\n\t                callback: function callback(clear) {\n\t                    that.bc.retired ? clear() : that.bc.updateCD = -10;\n\t                }\n\t            }));\n\t\n\t            // 按 '向上箭头' 旋转\n\t            game.registerAction(38, _action_controller2.default.new({\n\t                key: 'up',\n\t                once: true,\n\t                callback: function callback(clear) {\n\t                    that.bc.rotate();\n\t                }\n\t            }));\n\t\n\t            // 按 '空格' 降落\n\t            game.registerAction(32, _action_controller2.default.new({\n\t                key: 'space',\n\t                once: true,\n\t                callback: function callback(clear) {\n\t                    that.bc.drop();\n\t                }\n\t            }));\n\t\n\t            // 按 'R' 重置\n\t            game.registerAction(82, _action_controller2.default.new({\n\t                key: 'r',\n\t                once: true,\n\t                callback: function callback(clear) {\n\t                    that.resetGame();\n\t                }\n\t            }));\n\t\n\t            // 设置 'P' 成为game的 pause key\n\t            var pauseKeyCode = 80;\n\t            game.registerAction(pauseKeyCode, _action_controller2.default.new({\n\t                key: 'p',\n\t                once: true,\n\t                callback: function callback(clear) {\n\t                    game.isPaused() ? game.unpause() : game.pause();\n\t                }\n\t            }));\n\t            game.setPauseKeyCode(pauseKeyCode);\n\t        }\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            this.bc.init();\n\t        }\n\t    }, {\n\t        key: 'addScore',\n\t        value: function addScore(score) {\n\t            var sb = this.game.scoreBoard;\n\t            var sprev = sb.getNumber();\n\t            sb.setNumber(score + sprev);\n\t        }\n\t    }, {\n\t        key: 'countScore',\n\t        value: function countScore(rows) {\n\t            if (rows > 0) {\n\t                var ccb = this.game.clearCountBoard;\n\t                var cprev = ccb.getNumber();\n\t                ccb.setNumber(rows + cprev);\n\t\n\t                for (var n = 0; rows > 0; rows--) {\n\t                    n += rows;\n\t                }\n\t\n\t                this.addScore(n * 100);\n\t            }\n\t        }\n\t    }, {\n\t        key: 'resetGame',\n\t        value: function resetGame() {\n\t            var game = this.game;\n\t\n\t            game.replaceScene(_index2.default, 'Reset');\n\t            var s = game.storage;\n\t            var maxRecord = s.getMaxRecord();\n\t            var lastRecord = game.scoreBoard.getNumber();\n\t            if (lastRecord > maxRecord) {\n\t                s.setMaxRecord(lastRecord);\n\t            }\n\t            s.setLastRecord(lastRecord);\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            var bc = this.bc;\n\t            var game = this.game;\n\t            var area = game.area;\n\t\n\t            if (game.isPaused() || area.scoring) {\n\t                return;\n\t            }\n\t\n\t            if (bc.retired) {\n\t                if (bc.y < 0) {\n\t                    this.resetGame();\n\t                } else {\n\t                    bc.occupy();\n\t                    this.addScore(this.eachBlockScore);\n\t                    area.update();\n\t                    bc.init();\n\t                }\n\t            } else {\n\t                bc.update();\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return SceneMain;\n\t}(_game_scene2.default);\n\t\n\texports.default = SceneMain;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _preview = __webpack_require__(18);\n\t\n\tvar _preview2 = _interopRequireDefault(_preview);\n\t\n\tvar _function = __webpack_require__(6);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar BlockComb = function () {\n\t    function BlockComb(game) {\n\t        _classCallCheck(this, BlockComb);\n\t\n\t        this.game = game;\n\t        this.default();\n\t        this.setup();\n\t    }\n\t\n\t    _createClass(BlockComb, [{\n\t        key: 'default',\n\t        value: function _default() {\n\t            this.defaultColor = _const.occupiedColor;\n\t            this.indicateColor = _const.indicateColor;\n\t            // blockcomb 下降的CD\n\t            this.maxUpdateCD = Math.floor(this.game.fps / 1.5);\n\t        }\n\t    }, {\n\t        key: 'setup',\n\t        value: function setup() {\n\t            this.preview = _preview2.default.instance(this.game);\n\t            this.preview.next();\n\t        }\n\t\n\t        // change the attrs of blockComb instead of creating a new one\n\t        // when the game need another block combination\n\t\n\t    }, {\n\t        key: 'init',\n\t        value: function init() {\n\t            var p = this.preview;\n\t            this.coors = p.coors;\n\t            // update preivew\n\t            p.next();\n\t            p.clear();\n\t            p.draw();\n\t\n\t            // x and y indicate block combination's place in board\n\t            this.x = 3;\n\t            this.y = -(0, _function.coorDiff)(this.coors, 1) - 1;\n\t            this.color = this.defaultColor;\n\t            this.updateCD = this.maxUpdateCD;\n\t            this.retired = false; // retired 为真时重置 blockcomb\n\t        }\n\t    }, {\n\t        key: 'move',\n\t        value: function move(offset) {\n\t            if (this.retired) {\n\t                return;\n\t            }\n\t\n\t            var area = this.game.area;\n\t            if (!(0, _function.collide)(this.x + offset, this.y, this.coors, area)) {\n\t                this.x += offset;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'moveLeft',\n\t        value: function moveLeft() {\n\t            this.move(-1);\n\t        }\n\t    }, {\n\t        key: 'moveRight',\n\t        value: function moveRight() {\n\t            this.move(1);\n\t        }\n\t    }, {\n\t        key: 'rotate',\n\t        value: function rotate() {\n\t            if (this.retired) {\n\t                return;\n\t            }\n\t            // get rotated coordinates\n\t            var newCoors = this.rotateCoors(this.coors);\n\t            var area = this.game.area;\n\t            if (!(0, _function.collide)(this.x, this.y, newCoors, area)) {\n\t                this.coors = newCoors;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'rotateCoors',\n\t        value: function rotateCoors(coors) {\n\t            // rotate coordinates\n\t            var newCoors = coors.map(function (c) {\n\t                return [-c[1], c[0]];\n\t            });\n\t            // find the smallest one\n\t            var m = newCoors.sort(function (c1, c2) {\n\t                return c1[0] == c2[0] ? c1[1] - c2[1] : c1[0] - c2[0];\n\t            })[0];\n\t            // ensure the first one coor with 0 as x coordinate\n\t            return newCoors.map(function (c) {\n\t                return [c[0] - m[0], c[1] - m[1]];\n\t            });\n\t        }\n\t    }, {\n\t        key: 'drop',\n\t        value: function drop() {\n\t            if (this.game.area.scoring) {\n\t                return; // area 在计分时不能 drop\n\t            }\n\t            while (!this.retired) {\n\t                this.updateY();\n\t            }\n\t        }\n\t    }, {\n\t        key: 'occupy',\n\t        value: function occupy() {\n\t            var board = this.game.area.board;\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = this.coors[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var c = _step.value;\n\t\n\t                    try {\n\t                        var block = board[this.y + c[1]][this.x + c[0]];\n\t                        block.occupied = true;\n\t                        block.color = this.defaultColor;\n\t                    } catch (ex) {}\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'retire',\n\t        value: function retire() {\n\t            this.retired = true;\n\t            this.color = this.indicateColor;\n\t        }\n\t    }, {\n\t        key: 'isBlocked',\n\t        value: function isBlocked() {\n\t            var row,\n\t                block,\n\t                area = this.game.area;\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = this.coors[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var c = _step2.value;\n\t\n\t                    try {\n\t                        if (this.y + c[1] + 1 == area.row || area.board[this.y + c[1] + 1][this.x + c[0]].occupied) return true;\n\t                    } catch (err) {}\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t\n\t            return false;\n\t        }\n\t    }, {\n\t        key: 'draw',\n\t        value: function draw() {\n\t            var game = this.game;\n\t            var _iteratorNormalCompletion3 = true;\n\t            var _didIteratorError3 = false;\n\t            var _iteratorError3 = undefined;\n\t\n\t            try {\n\t                for (var _iterator3 = this.coors[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                    var c = _step3.value;\n\t\n\t                    game.drawBlock(this.x + c[0], this.y + c[1], this.color);\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError3 = true;\n\t                _iteratorError3 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                        _iterator3.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError3) {\n\t                        throw _iteratorError3;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'updateY',\n\t        value: function updateY() {\n\t            this.isBlocked() ? this.retire() : this.y++;\n\t        }\n\t    }, {\n\t        key: 'update',\n\t        value: function update() {\n\t            if (this.updateCD <= 0) {\n\t                this.updateCD = this.maxUpdateCD;\n\t                this.updateY();\n\t            } else {\n\t                this.updateCD--;\n\t            }\n\t        }\n\t    }], [{\n\t        key: 'instance',\n\t        value: function instance(game) {\n\t            this.i = this.i || new this(game);\n\t\n\t            return this.i;\n\t        }\n\t    }]);\n\t\n\t    return BlockComb;\n\t}();\n\t\n\texports.default = BlockComb;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _drawing_board = __webpack_require__(2);\n\t\n\tvar _drawing_board2 = _interopRequireDefault(_drawing_board);\n\t\n\tvar _const = __webpack_require__(5);\n\t\n\tvar _function = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// preview for next blockcomb\n\tvar Preview = function (_DrawingBoard) {\n\t    _inherits(Preview, _DrawingBoard);\n\t\n\t    function Preview(game) {\n\t        _classCallCheck(this, Preview);\n\t\n\t        var _this = _possibleConstructorReturn(this, (Preview.__proto__ || Object.getPrototypeOf(Preview)).call(this, '#next canvas'));\n\t\n\t        _this.game = game;\n\t        _this.default();\n\t        return _this;\n\t    }\n\t\n\t    // 更新 coors 供下一次 blockComb 重置使用\n\t\n\t\n\t    _createClass(Preview, [{\n\t        key: 'next',\n\t        value: function next() {\n\t            this.coors = this.randBlockType();\n\t            var diffX = (0, _function.coorDiff)(this.coors, 0);\n\t            this.offsetX = diffX == 1 ? 1 : diffX == 2 ? 0.5 : 0;\n\t            this.offsetY = (0, _function.coorDiff)(this.coors, 1) == 0 ? 0.5 : 0;\n\t        }\n\t    }, {\n\t        key: 'default',\n\t        value: function _default() {\n\t            this.color = _const.occupiedColor;\n\t        }\n\t    }, {\n\t        key: 'drawBlock',\n\t        value: function drawBlock(x, y) {\n\t            _get(Preview.prototype.__proto__ || Object.getPrototypeOf(Preview.prototype), 'drawBlock', this).call(this, x, y, this.game.blockSize, this.color);\n\t        }\n\t    }, {\n\t        key: 'randBlockType',\n\t        value: function randBlockType() {\n\t            var bt = _const.blockType;\n\t            return bt[Math.floor(Math.random() * bt.length)];\n\t        }\n\t    }, {\n\t        key: 'draw',\n\t        value: function draw() {\n\t            var coors = this.coors;\n\t\n\t            // draw blockComb preview\n\t            var offsetX = this.offsetX;\n\t            var offsetY = this.offsetY;\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = coors[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var c = _step.value;\n\t\n\t                    this.drawBlock(c[0] + offsetX, c[1] + offsetY);\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'clear',\n\t        value: function clear() {\n\t            var c = this.canvas;\n\t            this.ctx.clearRect(0, 0, c.width, c.height);\n\t        }\n\t    }]);\n\t\n\t    return Preview;\n\t}(_drawing_board2.default);\n\t\n\texports.default = Preview;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar events = {};\n\t\n\tvar ActionController = function () {\n\t    function ActionController(options) {\n\t        _classCallCheck(this, ActionController);\n\t\n\t        this.key = options.key;\n\t        this.callback = options.callback;\n\t        this.begin = options.begin || 100;\n\t        this.interval = options.interval || 50;\n\t        this.once = options.once;\n\t    }\n\t\n\t    _createClass(ActionController, [{\n\t        key: \"down\",\n\t\n\t\n\t        // 键盘按下\n\t        value: function down() {\n\t            var _this = this;\n\t\n\t            this.clearAll();\n\t            this.callback(function () {\n\t                _this.up();\n\t            });\n\t            if (this.once === true) {\n\t                return;\n\t            }\n\t            this.start = this.begin;\n\t            this.loop();\n\t        }\n\t\n\t        // 键盘松开\n\t\n\t    }, {\n\t        key: \"up\",\n\t        value: function up() {\n\t            clearTimeout(events[this.key]);\n\t            events[this.key] = null;\n\t        }\n\t    }, {\n\t        key: \"loop\",\n\t        value: function loop() {\n\t            var _this2 = this;\n\t\n\t            events[this.key] = setTimeout(function () {\n\t                _this2.start = null;\n\t                _this2.loop();\n\t                _this2.callback(function () {\n\t                    return _this2.up();\n\t                });\n\t            }, this.start || this.interval);\n\t        }\n\t    }, {\n\t        key: \"clearAll\",\n\t        value: function clearAll() {\n\t            for (var k in events) {\n\t                var p = events[k];\n\t                if (p) {\n\t                    clearTimeout(events[k]);\n\t                    events[k] = null;\n\t                }\n\t            }\n\t        }\n\t    }], [{\n\t        key: \"new\",\n\t        value: function _new(options) {\n\t            return new this(options);\n\t        }\n\t    }]);\n\t\n\t    return ActionController;\n\t}();\n\t\n\texports.default = ActionController;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GameInterface = function () {\n\t    function GameInterface() {\n\t        _classCallCheck(this, GameInterface);\n\t\n\t        this.root = document.querySelector('#root');\n\t        this.game = document.querySelector('#game');\n\t        this.button = document.querySelector('#button');\n\t        this.curW = 440; // width of game interface\n\t        this.curH = 677; // height of game interface\n\t        this.aspectRatio = this.curW / this.curH;\n\t        this.process = null;\n\t    }\n\t\n\t    _createClass(GameInterface, [{\n\t        key: 'getBrowserInterfaceSize',\n\t        value: function getBrowserInterfaceSize() {\n\t            var pageWidth = window.innerWidth;\n\t            var pageHeight = window.innerHeight;\n\t\n\t            if (typeof pageWidth != \"number\") {\n\t                //在标准模式下面\n\t                if (document.compatMode == \"CSS1Compat\") {\n\t                    pageWidth = document.documentElement.clientWidth;\n\t                    pageHeight = document.documentElement.clientHeight;\n\t                } else {\n\t                    pageWidth = document.body.clientWidth;\n\t                    pageHeight = window.body.clientHeight;\n\t                }\n\t            }\n\t\n\t            return {\n\t                pageWidth: pageWidth,\n\t                pageHeight: pageHeight\n\t            };\n\t        }\n\t    }, {\n\t        key: 'resize',\n\t        value: function resize() {\n\t            var r, g, b, w, h, p, size, scale;\n\t            r = this.root;\n\t            g = this.game;\n\t            b = this.button;\n\t            p = this.getBrowserInterfaceSize();\n\t            w = p.pageWidth;\n\t            h = p.pageHeight;\n\t\n\t            // 根据浏览器可用高度调整游戏界面\n\t            if (h != this.curH) {\n\t                var negSize, nextW, leftOffset, topOffset;\n\t                size = h / 677;\n\t                negSize = size - 1;\n\t                scale = 'scale(' + size + ')';\n\t                nextW = 440 * size; // 浏览器 height 对应的游戏所需最大宽度\n\t\n\t                // 不需要调整界面部件大小的情况\n\t                if (h < this.curH && nextW < this.curW || // 正在缩小\n\t                h > this.curH || nextW > this.curW) {\n\t                    // 正在扩大\n\t                    r.style.width = nextW + 'px';\n\t                    this.curW = nextW;\n\t\n\t                    leftOffset = 220 * negSize;\n\t                    g.style.transform = 'scale(' + size + ')';\n\t                    b.style.transform = 'scale(' + size + ')';\n\t                    g.style.marginLeft = leftOffset + 50 + 'px';\n\t                    b.style.marginLeft = leftOffset + 'px';\n\t                }\n\t\n\t                g.style.marginTop = 200 * negSize + 30 * size + 'px';\n\t                b.style.marginTop = 225 * negSize + 'px';\n\t\n\t                this.process = null;\n\t                this.curH = h;\n\t            }\n\t\n\t            // 根据浏览器可用宽度调整游戏界面\n\t            if (w < this.curH * this.aspectRatio) {\n\t                r.style.width = '100%';\n\t\n\t                if (w == this.curW) {\n\t                    return;\n\t                }\n\t\n\t                size = w / 440;\n\t                negSize = size - 1;\n\t                scale = 'scale(' + size + ')';\n\t\n\t                g.style.transform = b.style.transform = scale;\n\t                g.style.marginLeft = 220 * negSize + 50 + 'px';\n\t                b.style.marginLeft = 220 * negSize + 'px';\n\t                this.curW = w;\n\t            } else {\n\t                r.style.width = h * this.aspectRatio + 'px';\n\t            }\n\t        }\n\t    }], [{\n\t        key: 'new',\n\t        value: function _new() {\n\t            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t                args[_key] = arguments[_key];\n\t            }\n\t\n\t            return new (Function.prototype.bind.apply(this, [null].concat(args)))();\n\t        }\n\t    }]);\n\t\n\t    return GameInterface;\n\t}();\n\t\n\texports.default = GameInterface;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// app-1.0.0.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8fb050d3c9441db5ab91","import Game from './game/game'\r\nimport GameInterface from './view/game_interface'\r\nimport { isMobile } from './utils/function'\r\nimport style from '../css/index.css'\r\n\r\nwindow.onload = function() {\r\n    if (isMobile()) {\r\n        var o = { passive: false }\r\n    \r\n        // 禁止双指缩放 以及 阻止长按出现菜单\r\n        document.documentElement.addEventListener('touchstart', (event) => {\r\n            event.preventDefault();\r\n        }, o);\r\n        \r\n        // 禁止双击缩放\r\n        var lastTouchEnd = 0;\r\n        document.documentElement.addEventListener('touchend', (event) => {\r\n            var now = Date.now();\r\n            if (now - lastTouchEnd <= 300) {\r\n                event.preventDefault();\r\n            }\r\n            lastTouchEnd = now;\r\n        }, o);\r\n        \r\n        // 禁止滚动\r\n        document.documentElement.addEventListener('touchmove', (event) => {\r\n            event.preventDefault()\r\n        }, o)\r\n    }\r\n\r\n    // 调整界面\r\n    var gi = GameInterface.new()\r\n    gi.resize()\r\n    window.onresize = () => {\r\n        gi.resize()\r\n    }\r\n\r\n    // 开始游戏\r\n    var g = Game.instance(function (game) {\r\n        game.run()\r\n    })\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/main.js","import DrawingBoard from './drawing_board'\r\nimport EventController from './event_controller'\r\n\r\nimport Clock from './component/clock'\r\nimport PauseSign from './component/pause_sign'\r\nimport ScoreStorage from './storage/score'\r\n\r\nimport GameBoard from './game_board'\r\nimport GameArea from './game_area'\r\n\r\nimport SceneReset from '../scene/reset/index'\r\n\r\nexport default class Game extends DrawingBoard {\r\n    constructor(callback) {\r\n        super('#area')\r\n        this.blockSize = this.canvas.width / 10        \r\n        this.process = null\r\n        this.callbackRun = callback\r\n\r\n        this.default()\r\n        this.getComponent()\r\n        this.init()\r\n        this.setupEvent()\r\n        this.__start()\r\n    }\r\n    \r\n    default() {\r\n        this.fps = 30\r\n    }\r\n\r\n    init() {\r\n        this.scoreBoard.setTitle('Point')\r\n        this.scoreBoard.setNumber(0)\r\n        \r\n        this.clearCountBoard.setNumber(0)\r\n    }\r\n\r\n    getComponent() {\r\n        this.clock = Clock.new()\r\n        this.storage = ScoreStorage.new()\r\n        \r\n        this.scoreBoard = GameBoard.new('#point span', '#point p')\r\n        this.clearCountBoard = GameBoard.new('#cleans span', '#cleans p')\r\n        this.pauseSign = PauseSign.new()\r\n\r\n        this.area = GameArea.instance(this)\r\n        this.area.init()\r\n    }\r\n\r\n    setupEvent() {\r\n        this.eventCtrler = EventController.instance(this)\r\n    }\r\n\r\n    setPauseKeyCode(keyCode) {\r\n        this.eventCtrler.setPauseKeyCode(keyCode)\r\n    }\r\n\r\n    isPaused() {\r\n        return this.pauseSign.paused\r\n    }\r\n\r\n    pause() {\r\n        this.pauseSign.pause()\r\n    }\r\n\r\n    unpause() {\r\n        this.pauseSign.unpause()\r\n    }\r\n\r\n    registerAction(keyCode, controller) {\r\n        this.eventCtrler.registerController(keyCode, controller)\r\n    }\r\n\r\n    removeAllActions() {\r\n        this.eventCtrler.removeAllCallbacks()\r\n    }\r\n\r\n    replaceScene(Scene, name) {\r\n        // cancel the registered functions\r\n        // this.removeAllActions()\r\n        this.sceneName = name\r\n        this.scene = Scene.new(this)\r\n        // Scene.new will:\r\n        //      1st: create a singular instance at the first time or\r\n        //      2nd: just initialize the instance\r\n        this.eventCtrler.init()\r\n    }\r\n\r\n    drawBlock(x, y, color) {\r\n        super.drawBlock(x, y, this.blockSize, color)\r\n    }\r\n\r\n    draw() {\r\n        this.scene.draw()\r\n    }\r\n\r\n    update() {\r\n        this.scene.update()\r\n    }\r\n\r\n    runloop() {\r\n        //this.clear()\r\n        this.draw()\r\n        this.update()\r\n        this.process = setTimeout(() => {\r\n            this.runloop()\r\n        }, 1000 / this.fps);\r\n    }\r\n\r\n    run() {\r\n        this.process = setTimeout(() => {\r\n            this.runloop() \r\n        }, 1000 / this.fps);\r\n    }\r\n\r\n    __start() {\r\n        this.replaceScene(SceneReset)\r\n        this.callbackRun(this)\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/game.js","export default class DrawingBoard {\r\n    constructor(selectors) {\r\n        this.canvas = document.querySelector(selectors)\r\n        this.ctx = this.canvas.getContext('2d')\r\n    }\r\n\r\n    static instance(...args) {\r\n        this.i = this.i || new this(...args)\r\n        return this.i\r\n    }\r\n\r\n    drawBlock(x, y, bs, color) {\r\n        var gap, space, ctx, length, offsetX, offsetY\r\n        gap = bs / 15\r\n        space = bs / 10\r\n        ctx = this.ctx\r\n        \r\n        ctx.fillStyle = color\r\n        // 画外框\r\n        offsetX = bs * x + gap\r\n        offsetY = bs * y + gap\r\n        length = bs - 2 * gap        \r\n        ctx.fillRect(offsetX, offsetY, length, length)\r\n        \r\n        // 请空间隔\r\n        offsetX += gap\r\n        offsetY += gap\r\n        length -= 2 * gap\r\n        ctx.clearRect(offsetX, offsetY, length, length)\r\n\r\n        // 画正中间方块\r\n        length -= space * 2\r\n        ctx.fillRect(offsetX + space, offsetY + space,\r\n                     length, length)\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/drawing_board.js","import EventUtil from '../utils/event_util'\r\nimport { btnBindings, btnDownState, btnUpState } from '../const'\r\nimport { isMobile } from '../utils/function'\r\n\r\nvar log = console.log.bind()\r\n\r\nexport default class EventController extends EventUtil {\r\n    constructor(game) {\r\n        super()\r\n        this.game = game\r\n        // pauseKeyCode : a special key to unauthorize the use of all the other keys\r\n        this.pauseKeyCode = null\r\n        /* keyBinds     : will has attritutes as follows\r\n                {\r\n                    sceneControllers: { \r\n                        sceneName1 : controller1,\r\n                        sceneName2 : controller2,\r\n                        ... \r\n                    },\r\n                    component: component,\r\n                    actived: true or false,\r\n                }\r\n        */\r\n        this.keyBinds = {}\r\n        \r\n        this.processRawBinds()\r\n        this.setup()\r\n    }\r\n\r\n    setup() {\r\n        // 通过 actived 确保按住键盘不放时，绑定的事件只会触发一次\r\n        const down = (kc, controller) => {\r\n            if (!this.keyBinds[kc].actived) {\r\n                controller.down()\r\n                this.keyBinds[kc].actived = true\r\n            }\r\n        }\r\n        const up = (kc, controller) => {\r\n            this.keyBinds[kc].actived = false\r\n            controller.up()\r\n        }\r\n        var buttons = document.querySelector('#button')\r\n        this.addKBHandler(window, 'keydown', btnDownState, down)\r\n        this.addKBHandler(window, 'keyup', btnUpState, up)\r\n        \r\n        var ism = isMobile()\r\n        const start = ism ? 'touchstart' : 'mousedown'\r\n        const out = 'mouseout'\r\n        const end = ism ? 'touchend' : 'mouseup'\r\n        this.addMouseHandler(buttons, start, btnDownState, down)\r\n        this.addMouseHandler(buttons, end, btnUpState, up)\r\n        this.addMouseHandler(buttons, out, btnUpState, up)\r\n        // 当 user 没有在按钮里面结束鼠标事件时，如果是不会触发 mouseup 事件的\r\n        // 只有用 mouseout 才能保证按键能正常结束，恢复原来的按键状况\r\n    }\r\n\r\n    init() {\r\n        for (var k in this.keyBinds) {\r\n            if (this.keyBinds[k]) {\r\n                this.keyBinds[k].actived = false\r\n            }\r\n        }\r\n    }\r\n\r\n    setPauseKeyCode(keycode) {\r\n        this.pauseKeyCode = keycode.toString()\r\n    }\r\n\r\n    // 处理设置好的 bindings 得到 keyCodes 对应的元素\r\n    processRawBinds() {\r\n        var rawBinds = btnBindings\r\n        var binds = {}\r\n        for (var [keyCode, sel] of rawBinds) {\r\n            binds[keyCode] = {\r\n                component: document.querySelector(sel),\r\n                sceneControllers: {},\r\n                actived: false,\r\n            }\r\n        }\r\n        this.keyBinds = binds\r\n    }\r\n\r\n    // 根据当前的 game.sceneName 来设置 controller (EventController 实例)\r\n    registerController(keyCode, controller) {\r\n        var binds = this.keyBinds[keyCode]\r\n        var sceneName = this.game.sceneName\r\n\r\n        if (!binds) {\r\n            binds = this.keyBinds[keyCode] = {\r\n                sceneControllers: {},\r\n                actived: false,\r\n            }\r\n        }\r\n        var sctrls = binds.sceneControllers\r\n        sctrls[sceneName] = controller\r\n    }\r\n\r\n    // 对 keybinds 里的对象添加键盘事件\r\n    addKBHandler(element, type, state, callback) {\r\n        log('add', type, 'handler of btns to', element.toString())\r\n        var game = this.game\r\n        this.addHandler(element, type, (event) => {\r\n            this.keyboardHandler(event, state, callback)\r\n        })\r\n    }\r\n\r\n    keyboardHandler(event, state, callback) {\r\n        var kc = event.keyCode\r\n        var game = this.game\r\n        if (kc in this.keyBinds) {\r\n            var bind = this.keyBinds[kc]\r\n            var paused = game.isPaused()\r\n            var cpn = bind.component\r\n            var ctrl = bind.sceneControllers[game.sceneName] // 得到当前场景对应的注册controller\r\n            if (cpn) {\r\n                // 更新组件的状态\r\n                cpn.className = state\r\n            }\r\n            if (!(paused && kc != this.pauseKeyCode) && ctrl) {\r\n                callback(kc, ctrl)\r\n            }\r\n        }\r\n    }\r\n\r\n    // 对 keybinds 里的对象添加鼠标事件\r\n    addMouseHandler(element, type, state, callback) {\r\n        log('add', type, 'handler of btns to btns')\r\n        this.addHandler(window, type, (event) => {\r\n            this.mouseHandler(event, state, callback)\r\n        })\r\n    }\r\n\r\n    mouseHandler(event, state, callback) {\r\n        var e = this.getTarget(event)\r\n        var paused = this.game.isPaused()\r\n        for (var kc in this.keyBinds) {\r\n            var bind = this.keyBinds[kc]\r\n            var cpn = bind.component\r\n            var ctrl = bind.sceneControllers[this.game.sceneName]\r\n            if (cpn !== e) {\r\n                continue\r\n            }\r\n\r\n            cpn.className = state\r\n            if (!(paused && kc !== this.pauseKeyCode) && ctrl) {\r\n                return callback(kc, ctrl)\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/event_controller.js","export default class EventUtil {\r\n    constructor() {}\r\n\r\n    static instance(...args) {\r\n        this.i = this.i || new this(...args)\r\n        return this.i\r\n    }\r\n\r\n    getEvent() {\r\n        return event ? event : window.event\r\n    }\r\n\r\n    getTarget(event) {\r\n        return event.target || event.srcElement\r\n    }\r\n\r\n    preventDefault(event) {\r\n        if (event.preventDefault) {\r\n            event.preventDefault()\r\n        } else {\r\n            event.returnValue = false\r\n        }\r\n    }\r\n\r\n    stopPropagation(event) {\r\n        if (event.stopPropagation) {\r\n            event.stopPropagation()\r\n        } else {\r\n            event.cancelBubble = true\r\n        }\r\n    }\r\n\r\n    addHandler(element, type, handler) {\r\n        if (element.addEventListener) {\r\n            element.addEventListener(type, handler)\r\n        } else if (element.attachEvent) {\r\n            element.attachEvent('on' + type, handler)\r\n        } else {\r\n            element['on' + type] = handler\r\n        }\r\n    }\r\n\r\n    removeHandler(element, type, handler) {\r\n        if (element.removeEventListener) {\r\n            element.removeEventListener(type, handler)\r\n        } else if (element.detachEvent) {\r\n            element.detachEvent('on' + type, handler);\r\n        } else {\r\n            element['on' + type] = handler\r\n        }\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/event_util.js","const blockType = [ \r\n                    [[0, 0], [1, 0], [2, 0], [3, 0]],\r\n                    [[0, 0], [0, 1], [1, 0], [1, 1]],\r\n                    [[0, 1], [1, 0], [1, 1], [2, 1]],\r\n                    [[0, 0], [0, 1], [1, 1], [2, 1]],\r\n                    [[0, 1], [1, 1], [2, 0], [2, 1]],\r\n                    [[0, 0], [1, 0], [1, 1], [2, 1]],\r\n                    [[0, 1], [1, 0], [1, 1], [2, 0]],\r\n]\r\n\r\n// button_bindings : contains [keyCode, sel] pairs\r\n// sel             : the id of related button\r\nconst btnBindings = [\r\n                        [38, '#rotate_btn'], // arrow up\r\n                        [40,   '#down_btn'], // arrow down\r\n                        [37,   '#left_btn'], // arrow left\r\n                        [39,  '#right_btn'], // arrow right\r\n                        [32,   '#drop_btn'], // space\r\n                        [80,  '#pause_btn'], // p\r\n                        [82,  '#reset_btn'], // r\r\n]\r\n\r\nconst btnDownState = 'pressed'\r\nconst btnUpState = ''\r\n\r\nconst pauseState = 'paused'\r\nconst unpauseState = 'unpaused'\r\n\r\nconst tikState = 'tik'\r\nconst tokState = 'tok'\r\n\r\nconst defaultColor = 'rgb(135, 147, 100)'    // 方块没有被占据时的颜色\r\nconst occupiedColor = 'rgb(0, 0, 0)'         // 方块被占据时的颜色\r\nconst indicateColor = 'rgb(180, 0, 0)'       // 高亮显示方块时的颜色\r\n\r\nexport {\r\n    blockType,\r\n    btnBindings,\r\n    btnDownState,\r\n    btnUpState,\r\n    pauseState,\r\n    unpauseState,\r\n    tikState,\r\n    tokState,\r\n    defaultColor,\r\n    occupiedColor,\r\n    indicateColor,\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/const.js","var collide = function (x, y, coors, area) {\r\n    if (x < 0 || x + coors[3][0] >= area.column) {\r\n        return true\r\n    }\r\n\r\n    return coors.map((c) => {\r\n        // y + c[1] < 0 means the block is above the field\r\n        // so literally it dosen't collides\r\n        var coorY = y + c[1]\r\n        return !(coorY < 0 || !area.board[coorY][x + c[0]].occupied)\r\n    }).reduce((prev, cond) => {\r\n        return prev || cond\r\n    })\r\n}\r\n\r\nvar coorDiff = function (coors, index) {\r\n    var array = coors.map(c => {\r\n        return c[index]\r\n    })\r\n    return array.reduce((max, num) => {\r\n        return Math.max(max, num)\r\n    }) - array.reduce((min, num) => {\r\n        return Math.min(min, num)\r\n    })\r\n}\r\n\r\nvar isMobile = function () {\r\n    // 判断是否为移动端\r\n    const ua = navigator.userAgent;\r\n    const android = /Android (\\d+\\.\\d+)/.test(ua);\r\n    const iphone = ua.indexOf('iPhone') > -1;\r\n    const ipod = ua.indexOf('iPod') > -1;\r\n    const ipad = ua.indexOf('iPad') > -1;\r\n    const nokiaN = ua.indexOf('NokiaN') > -1;\r\n    return android || iphone || ipod || ipad || nokiaN;\r\n}\r\n\r\nexport {\r\n    collide,\r\n    coorDiff,\r\n    isMobile,\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/function.js","import GameIndicator from '../game_indicator'\r\nimport GameBoard from '../game_board'\r\nimport { tikState, tokState } from '../../const'\r\n\r\nexport default class Clock {\r\n    constructor(game) {\r\n        this.game = game\r\n        this.setup()\r\n    }\r\n\r\n    static new(...args) {\r\n        return new this(...args)\r\n    }\r\n\r\n    setup() {\r\n        this.hourBoard = GameBoard.new('#s_hour span')\r\n        this.minuteBoard = GameBoard.new('#s_minute span')\r\n        this.indicator = GameIndicator.new('#s_clock_indi')\r\n        \r\n        var now = new Date()\r\n        this.hours = now.getHours()\r\n        this.minutes = now.getMinutes()\r\n        this.seconds = now.getSeconds()\r\n\r\n        this.hourBoard.setNumber(this.hours)\r\n        this.minuteBoard.setNumber(this.minutes)\r\n\r\n        setInterval(() => {\r\n            this.update()\r\n        }, 1000)\r\n    }\r\n\r\n    update() {\r\n        if (++this.seconds == 60) {\r\n            this.seconds = 0\r\n            if (++this.minutes == 60) {\r\n                this.minutes = 0\r\n                if (++this.hours == 24) {\r\n                    this.hours = 0\r\n                }\r\n                this.hourBoard.setNumber(this.hours)\r\n            }\r\n            this.minuteBoard.setNumber(this.minutes)\r\n        }\r\n        \r\n        var state = this.seconds % 2 == 0 ? tikState : tokState\r\n        this.indicator.setState(state)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/component/clock.js","export default class GameIndicator {\r\n    // 用来管理 状态指示器\r\n    constructor(sel) {\r\n        this.component = document.querySelector(sel)\r\n    }\r\n    \r\n    static new(...args) {\r\n        return new this(...args)\r\n    }\r\n\r\n    setState(state) {\r\n        this.component.className = state\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/game_indicator.js","export default class GameBoard {\r\n    // Board 用来管理跟数字有关的 elements\r\n    constructor(eltsSel, titleSel) {\r\n        this.numElts = document.querySelectorAll(eltsSel)\r\n        if (titleSel) {\r\n            this.titleCpn = document.querySelector(titleSel)\r\n        }\r\n    }\r\n\r\n    static new(...args) {\r\n        return new this(...args)\r\n    }\r\n\r\n    setTitle(str) {\r\n        this.titleCpn.innerText = str\r\n    }\r\n\r\n    // 通过判断元素的样式来计算所显示的数字的大小\r\n    getNumber() {\r\n        var lastChar, eltClass, n, sum = 0\r\n        for (var i = this.numElts.length - 1; i >= 0; i--) {\r\n            eltClass = this.numElts[i].className\r\n            lastChar = eltClass == '' ? 0 : eltClass[eltClass.length-1]\r\n            n = parseInt(lastChar)\r\n            if (!isNaN(n)) {\r\n                sum = 10 * sum + n\r\n            }\r\n        }\r\n        return sum\r\n    }\r\n\r\n    // 通过改变元素的样式来改变显示的数字\r\n    setNumber(num) {\r\n        var r, length = this.numElts.length\r\n        for (var i = 0; i < length && num > 0; i++) {\r\n            r = num % 10\r\n            this.setDigit(r, this.numElts[i])\r\n            num = (num - r) / 10\r\n        }\r\n\r\n        if (i == 0) {\r\n            this.setDigit(0, this.numElts[0])\r\n            i++\r\n        }\r\n        for (; i < length; i++) {\r\n            this.setDigit(null, this.numElts[i])\r\n        }\r\n    }\r\n\r\n    // digit 为 null 时清除状态\r\n    // 否则就设置与 digit 相对应的数字状态\r\n    setDigit(digit, elt) {\r\n        elt.className = digit == null ? '' : 'n' + digit\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/game_board.js","import GameIndicator from '../game_indicator'\r\nimport { pauseState, unpauseState } from '../../const'\r\n\r\nexport default class PauseSign extends GameIndicator {\r\n    // 用来管理 暂停功能 以及 在游戏界面中的暂停标志\r\n    constructor() {\r\n        super('#s_psign')\r\n        this.process = null\r\n        this.paused = false\r\n        this.count = 0\r\n    }\r\n\r\n    pause() {\r\n        this.paused = true\r\n        this.process = setInterval(() => {\r\n            this.count++ % 2 == 0 ? this.setState(pauseState) :\r\n                                    this.setState(unpauseState)\r\n        }, 1000 / 4)\r\n    }\r\n\r\n    unpause() {\r\n        this.paused = false\r\n        this.count = 0\r\n        this.setState(unpauseState)\r\n        clearInterval(this.process)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/component/pause_sign.js","const keys = {\r\n    lastRecordKey: \"tetris-last-record\",\r\n    maxRecordKey: \"tetris-max-record\",\r\n}\r\n\r\nexport default class ScoreStorage {\r\n    constructor() {\r\n        this.storage = this.getLocalStorage()\r\n    }\r\n\r\n    static new() {\r\n        return new this()\r\n    }\r\n\r\n    getLocalStorage() {\r\n        if (typeof localStorage == 'object') {\r\n            return localStorage\r\n        } else if (typeof globalStorage == 'object') {\r\n            return globalStorage[location.host]\r\n        } else {\r\n            console.warn('Local storage not available. Your record will be forgetted after leave')\r\n            return {}\r\n        }\r\n    }\r\n\r\n    getRecord(key) {\r\n        var num = parseInt(this.storage[key])\r\n        return isNaN(num) ? 0 : num\r\n    }\r\n\r\n    setRecord(key, val) {\r\n        this.storage[key] = val\r\n    }\r\n\r\n    getLastRecord() {\r\n        return this.getRecord(keys.lastRecordKey)\r\n    }\r\n\r\n    setLastRecord(num) {\r\n        this.setRecord(keys.lastRecordKey, num)\r\n    }\r\n\r\n    getMaxRecord() {\r\n        return this.getRecord(keys.maxRecordKey)\r\n    }\r\n\r\n    setMaxRecord(num) {\r\n        this.setRecord(keys.maxRecordKey, num)\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/storage/score.js","import { defaultColor, indicateColor } from '../const'\r\n\r\nexport default class GameArea {\r\n    constructor (game) {\r\n        this.game = game\r\n        this.board = []\r\n        this.scoring = false\r\n        this.process = null\r\n        this.count = 0\r\n        this.default()\r\n    }\r\n\r\n    static instance(game) {\r\n        this.i = this.i || new this(game)\r\n        return this.i\r\n    }\r\n\r\n    default() {\r\n        this.row = 20\r\n        this.column = 10\r\n        this.defaultColor = defaultColor\r\n        this.indicateColor = indicateColor\r\n        this.fullLinesEchoSpeed = 15    // board 中的满行显示的速度\r\n        this.fullLinesEchoTimes = 3     // 重复显示 board 中满行的次数\r\n    }\r\n\r\n    init() {\r\n        for (var i = 0; i < this.row; i++) {\r\n            this.board[i] = []\r\n            var line = this.board[i]\r\n            for (var j = 0; j < this.column; j++) {\r\n                line[j] = {\r\n                    color: this.defaultColor,\r\n                    occupied: false,\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    setLine(lineIndex, color, occupied) {\r\n        var line = this.board[lineIndex]\r\n        for (var i = 0; i < this.column; i++) {\r\n            var block = line[i]\r\n            block.color = color\r\n            block.occupied = occupied\r\n        }\r\n    }\r\n\r\n    setUpScoreRule(scene) {\r\n        this.scoreFunc = function(rows) {\r\n            scene.countScore(rows)\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        var game = this.game\r\n        for (var i = 0; i < this.row; i++) {\r\n            for (var j = 0; j < this.column; j++) {\r\n                game.drawBlock(j, i, this.board[i][j].color)\r\n            }\r\n        }\r\n    }\r\n\r\n    update() {\r\n        var lines = []\r\n        for (var i = 0; i < this.row; i++) {\r\n            var full = this.board[i].map((b) => {\r\n                return b.occupied\r\n            }).reduce((prev, cur) => {\r\n                return prev && cur\r\n            })\r\n\r\n            if (full) {\r\n                lines.push(i)\r\n            }\r\n        }\r\n        \r\n        if (lines.length > 0) {\r\n            this.scoring = true\r\n            this.lines = lines\r\n            this.score()\r\n        }\r\n    }\r\n\r\n    // 通过更新 full lines 的颜色来高亮显示 full lines\r\n    echoFullLines() {\r\n        // 游戏暂停时不更新\r\n        if (this.game.isPaused()) {\r\n            return\r\n        }\r\n\r\n        if (this.count++ > this.fullLinesEchoTimes * 2 - 1) {\r\n            this.count = 0\r\n            this.scoring = false\r\n            clearInterval(this.process)\r\n            this.clearFullLines()\r\n            return\r\n        }\r\n        var color = this.count % 2 == 0 ? this.defaultColor \r\n                                        : this.indicateColor\r\n        this.lines.map((li) => {\r\n            this.setLine(li, color, false)\r\n        })\r\n    }\r\n\r\n    // 在 echoFullLines() 中 full lines 的颜色已设置成\r\n    // defaultColor 因此直接将它移到数组顶部\r\n    clearFullLines() {\r\n        var ls = this.lines\r\n        ls.forEach((li) => {\r\n            var deleted = this.board.splice(li, 1)[0]\r\n            this.board.unshift(deleted)\r\n        })\r\n        this.scoreFunc(ls.length)\r\n        this.lines = null\r\n    }\r\n\r\n    score() {\r\n        this.scoring = true\r\n        this.process = setInterval(() => {\r\n            this.echoFullLines()\r\n        }, 1000 / this.fullLinesEchoSpeed)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/game_area.js","import GameScene from '../../game/game_scene'\r\nimport SceneTitle from '../title/index'\r\nimport { occupiedColor, defaultColor } from '../../const'\r\n\r\nexport default class SceneReset extends GameScene {\r\n    constructor (game) {\r\n        super(game)\r\n    }\r\n\r\n    setup() {\r\n        this.pushElement(this.game.area)\r\n    }\r\n\r\n    init() {\r\n        this.index = 19\r\n        this.update = this.fillArea\r\n    }\r\n\r\n    fillArea() {\r\n        var area = this.game.area\r\n        area.setLine(this.index, occupiedColor, false)\r\n        if (--this.index < 0) {\r\n            this.index = 0\r\n            this.update = this.clearArea\r\n        }\r\n    }\r\n    \r\n    clearArea() {\r\n        var area = this.game.area\r\n        area.setLine(this.index, defaultColor, false)\r\n        if (++this.index == 20) {\r\n            this.restartGame()\r\n        }\r\n    }\r\n\r\n    restartGame() {\r\n        this.game.replaceScene(SceneTitle, 'title')\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/scene/reset/index.js","export default class GameScene {\r\n    constructor (game) {\r\n        this.game = game\r\n        this.elements = []\r\n        this.setup()\r\n    }\r\n\r\n    static new(game) {\r\n        this.i = this.i || new this(game)\r\n        this.i.init()\r\n        return this.i\r\n    }\r\n\r\n    setup() {}\r\n\r\n    init() {}\r\n\r\n    draw() {\r\n        for (var e of this.elements) {\r\n            e.draw()\r\n        }\r\n    }\r\n\r\n    update() {}\r\n\r\n    pushElement(elt) {\r\n        this.elements.push(elt)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game/game_scene.js","import GameScene from '../../game/game_scene'\r\nimport SceneMain from '../main/index'\r\nimport ActionController from '../../utils/action_controller'\r\n\r\nexport default class SceneTitle extends GameScene {\r\n    constructor (game) {\r\n        super(game)\r\n        this.title = document.querySelector('#title')\r\n        this.showGap = Math.floor(game.fps * 0.75)\r\n        this.titleShowGap = game.fps * 2\r\n        this.count = 0\r\n        this.titleType = 1\r\n    }\r\n\r\n    setup() {\r\n        var game = this.game\r\n        var that = this\r\n\r\n        // 按 空格 开始游戏\r\n        game.registerAction(32, ActionController.new({\r\n            key: 'space',\r\n            once: true,\r\n            callback: (clear) => {\r\n                that.startGame()\r\n            },\r\n        }))\r\n    }\r\n\r\n    init() {\r\n        var game = this.game\r\n\r\n        game.area.draw()\r\n    }\r\n\r\n    startGame() {\r\n        var game =  this.game\r\n        game.replaceScene(SceneMain, 'main')\r\n        game.init()\r\n        this.title.style.visibility = 'hidden'\r\n    }\r\n\r\n    update() {\r\n        var t = this.title\r\n        var game = this.game\r\n        if (this.count % this.showGap == 0) {\r\n            var visible = t.style.visibility == 'visible'\r\n            t.style.visibility = visible ? 'hidden' : 'visible'\r\n        }\r\n        if (this.count % this.titleShowGap == 0) {\r\n            var sb = game.scoreBoard\r\n            var s = game.storage\r\n            if (this.titleType) {\r\n                sb.setTitle('Max')\r\n                sb.setNumber(s.getMaxRecord())\r\n            } else {\r\n                sb.setTitle('Last Round')\r\n                sb.setNumber(s.getLastRecord())\r\n            }\r\n            this.titleType = !this.titleType\r\n        }\r\n        this.count++\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/scene/title/index.js","import GameScene from '../../game/game_scene'\r\nimport BlockComb from './blockcomb'\r\nimport SceneReset from '../reset/index'\r\nimport ActionController from '../../utils/action_controller'\r\n\r\nexport default class SceneMain extends GameScene {\r\n    constructor (game) {\r\n        super(game)\r\n    }\r\n\r\n    setup() {\r\n        var that = this\r\n        var game = this.game\r\n        var area = game.area\r\n\r\n        this.eachBlockScore = 10\r\n\r\n        this.bc = BlockComb.instance(game)\r\n        this.pushElement(area)\r\n        this.pushElement(this.bc)\r\n       \r\n        area.setUpScoreRule(this)\r\n\r\n        // 按 '向左箭头' 左移\r\n        game.registerAction(37, ActionController.new({\r\n            key: 'left',\r\n            begin: 200,\r\n            interval: 100,\r\n            callback: (clear) => {\r\n                that.bc.moveLeft()\r\n            },\r\n        }))\r\n\r\n        // 按 '向右箭头' 右移\r\n        game.registerAction(39, ActionController.new({\r\n            key: 'right',\r\n            begin: 200,\r\n            interval: 100,\r\n            callback: (clear) => {\r\n                that.bc.moveRight()\r\n            },\r\n        }))\r\n        \r\n        // 按 '向下箭头' 加速\r\n        game.registerAction(40, ActionController.new({\r\n            key: 'down',\r\n            callback: (clear) => {\r\n                that.bc.retired ? clear() : that.bc.updateCD = -10\r\n            },\r\n        }))\r\n        \r\n        // 按 '向上箭头' 旋转\r\n        game.registerAction(38, ActionController.new({\r\n            key: 'up',\r\n            once: true,\r\n            callback: (clear) => {\r\n                that.bc.rotate()\r\n            },\r\n        }))\r\n\r\n        // 按 '空格' 降落\r\n        game.registerAction(32, ActionController.new({\r\n            key: 'space',\r\n            once: true,\r\n            callback: (clear) => {\r\n                that.bc.drop()\r\n            },\r\n        }))\r\n\r\n        // 按 'R' 重置\r\n        game.registerAction(82, ActionController.new({\r\n            key: 'r',\r\n            once: true,\r\n            callback: (clear) => {\r\n                that.resetGame()\r\n            },\r\n        }))\r\n\r\n        // 设置 'P' 成为game的 pause key\r\n        var pauseKeyCode = 80\r\n        game.registerAction(pauseKeyCode, ActionController.new({\r\n            key: 'p',\r\n            once: true,\r\n            callback: (clear) => {\r\n                game.isPaused() ? game.unpause() : game.pause()\r\n            },\r\n        }))\r\n        game.setPauseKeyCode(pauseKeyCode)\r\n    }\r\n\r\n    init() {\r\n        this.bc.init()\r\n    }\r\n\r\n    addScore(score) {\r\n        var sb = this.game.scoreBoard\r\n        var sprev = sb.getNumber()\r\n        sb.setNumber(score + sprev)\r\n    }\r\n\r\n    countScore(rows) {\r\n        if (rows > 0) {\r\n            var ccb = this.game.clearCountBoard\r\n            var cprev = ccb.getNumber()\r\n            ccb.setNumber(rows + cprev)\r\n            \r\n            for (var n = 0; rows > 0; rows--) {\r\n                n += rows\r\n            }\r\n\r\n            this.addScore(n * 100)\r\n        }\r\n    }\r\n\r\n    resetGame() {\r\n        var game = this.game\r\n        \r\n        game.replaceScene(SceneReset, 'Reset')\r\n        var s = game.storage\r\n        var maxRecord = s.getMaxRecord()\r\n        var lastRecord = game.scoreBoard.getNumber()\r\n        if (lastRecord > maxRecord) {\r\n            s.setMaxRecord(lastRecord)\r\n        }\r\n        s.setLastRecord(lastRecord)\r\n    }\r\n\r\n    update() {\r\n        var bc = this.bc\r\n        var game = this.game\r\n        var area = game.area        \r\n\r\n        if (game.isPaused() || area.scoring) {\r\n            return\r\n        }\r\n        \r\n        if (bc.retired) {\r\n            if (bc.y < 0) {\r\n                this.resetGame()\r\n            } else {\r\n                bc.occupy()\r\n                this.addScore(this.eachBlockScore)                \r\n                area.update()\r\n                bc.init()\r\n            }\r\n        } else {\r\n            bc.update()\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/scene/main/index.js","import Preview from './preview'\r\nimport { collide, coorDiff } from '../../utils/function'\r\nimport { occupiedColor, indicateColor } from '../../const'\r\n\r\nexport default class BlockComb {\r\n    constructor (game) {\r\n        this.game = game\r\n        this.default()\r\n        this.setup()\r\n    }\r\n\r\n    static instance(game) {\r\n        this.i = this.i || new this(game)\r\n\r\n        return this.i\r\n    }\r\n\r\n    default() {\r\n        this.defaultColor = occupiedColor\r\n        this.indicateColor = indicateColor\r\n        // blockcomb 下降的CD\r\n        this.maxUpdateCD = Math.floor(this.game.fps / 1.5)\r\n    }\r\n\r\n    setup() {\r\n        this.preview = Preview.instance(this.game)\r\n        this.preview.next()\r\n    }\r\n\r\n    // change the attrs of blockComb instead of creating a new one\r\n    // when the game need another block combination\r\n    init() {\r\n        var p = this.preview\r\n        this.coors = p.coors\r\n        // update preivew\r\n        p.next()\r\n        p.clear()\r\n        p.draw()\r\n\r\n        // x and y indicate block combination's place in board\r\n        this.x = 3\r\n        this.y = -coorDiff(this.coors, 1) - 1\r\n        this.color = this.defaultColor\r\n        this.updateCD = this.maxUpdateCD\r\n        this.retired = false    // retired 为真时重置 blockcomb\r\n    }\r\n\r\n    move(offset) {\r\n        if (this.retired) {\r\n            return\r\n        }\r\n        \r\n        var area = this.game.area\r\n        if (! collide(this.x+offset, this.y, this.coors, area)) {\r\n            this.x += offset\r\n        }\r\n    }\r\n\r\n    moveLeft() {\r\n        this.move(-1)\r\n    }\r\n\r\n    moveRight() {\r\n        this.move(1)\r\n    }\r\n\r\n    rotate() {\r\n        if (this.retired) {\r\n            return\r\n        }\r\n        // get rotated coordinates\r\n        var newCoors = this.rotateCoors(this.coors)\r\n        var area = this.game.area\r\n        if (! collide(this.x, this.y, newCoors, area)) {\r\n            this.coors = newCoors\r\n        }\r\n    }\r\n\r\n    rotateCoors(coors) {\r\n        // rotate coordinates\r\n        var newCoors = coors.map(c => [-c[1], c[0]])\r\n        // find the smallest one\r\n        var m = newCoors.sort(function (c1, c2) {\r\n            return c1[0] == c2[0] ? c1[1] - c2[1] : c1[0] - c2[0]\r\n        })[0]\r\n        // ensure the first one coor with 0 as x coordinate\r\n        return newCoors.map(c => [c[0]-m[0], c[1]-m[1]])\r\n    }\r\n\r\n    drop() {\r\n        if (this.game.area.scoring) {\r\n            return  // area 在计分时不能 drop\r\n        }\r\n        while (!this.retired) {\r\n            this.updateY()\r\n        }\r\n    }\r\n\r\n    occupy() {\r\n        var board = this.game.area.board\r\n        for (var c of this.coors) {\r\n            try {\r\n                var block = board[this.y + c[1]][this.x + c[0]]\r\n                block.occupied = true\r\n                block.color = this.defaultColor\r\n            } catch(ex) {\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    retire() {\r\n        this.retired = true\r\n        this.color = this.indicateColor\r\n    }\r\n\r\n    isBlocked() {\r\n        var row, block, area = this.game.area\r\n        for (var c of this.coors) {\r\n            try {\r\n                if (this.y + c[1] + 1 == area.row ||\r\n                    area.board[this.y + c[1] + 1][this.x + c[0]].occupied)\r\n                    return true\r\n            } catch (err) {\r\n                \r\n            }\r\n        }\r\n        return false\r\n    }\r\n    \r\n    draw() {\r\n        var game = this.game\r\n        for (var c of this.coors) {\r\n            game.drawBlock(this.x + c[0], this.y + c[1], this.color)\r\n        }\r\n    }\r\n\r\n    updateY() {\r\n        this.isBlocked() ? this.retire() : this.y++\r\n    }\r\n\r\n    update() {\r\n        if (this.updateCD <= 0) {\r\n            this.updateCD = this.maxUpdateCD\r\n            this.updateY()\r\n        } else {\r\n            this.updateCD--\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/scene/main/blockcomb.js","import DrawingBoard from '../../game/drawing_board'\r\nimport { blockType } from '../../const'\r\nimport { occupiedColor } from '../../const'\r\nimport { coorDiff } from '../../utils/function'\r\n\r\n// preview for next blockcomb\r\nexport default class Preview extends DrawingBoard {\r\n    constructor(game) {\r\n        super('#next canvas')\r\n        this.game = game\r\n        this.default()\r\n    }\r\n\r\n    // 更新 coors 供下一次 blockComb 重置使用\r\n    next() {\r\n        this.coors = this.randBlockType()\r\n        var diffX = coorDiff(this.coors, 0)\r\n        this.offsetX = diffX == 1 ? 1 : diffX == 2 ? 0.5 : 0\r\n        this.offsetY = coorDiff(this.coors, 1) == 0 ? 0.5 : 0\r\n    }\r\n\r\n    default() {\r\n        this.color = occupiedColor\r\n    }\r\n\r\n    drawBlock(x, y) {\r\n        super.drawBlock(x, y, this.game.blockSize, this.color)\r\n    }\r\n\r\n    randBlockType() {\r\n        var bt = blockType\r\n        return bt[Math.floor(Math.random() * bt.length)]    \r\n    }\r\n\r\n    draw() {\r\n        var coors = this.coors\r\n        \r\n        // draw blockComb preview\r\n        var offsetX = this.offsetX\r\n        var offsetY = this.offsetY\r\n        for (var c of coors) {\r\n            this.drawBlock(c[0] + offsetX, c[1] + offsetY)\r\n        }\r\n    }\r\n\r\n    clear() {\r\n        var c = this.canvas\r\n        this.ctx.clearRect(0, 0, c.width, c.height)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/scene/main/preview.js","var events = {}\r\n\r\nexport default class ActionController {\r\n    constructor(options) {\r\n        this.key = options.key\r\n        this.callback = options.callback\r\n        this.begin = options.begin || 100\r\n        this.interval = options.interval || 50\r\n        this.once = options.once\r\n    }\r\n\r\n    static new(options) {\r\n        return new this(options)\r\n    }\r\n\r\n    // 键盘按下\r\n    down() {\r\n        this.clearAll()\r\n        this.callback(() => {\r\n            this.up()\r\n        })\r\n        if (this.once === true) {\r\n            return\r\n        }\r\n        this.start = this.begin\r\n        this.loop()\r\n    }\r\n\r\n    // 键盘松开\r\n    up() {\r\n        clearTimeout(events[this.key])\r\n        events[this.key] = null\r\n    }\r\n\r\n    loop() {\r\n        events[this.key] = setTimeout(() => {\r\n            this.start = null\r\n            this.loop()\r\n            this.callback(() => this.up())\r\n        }, this.start || this.interval)\r\n    }\r\n\r\n    clearAll() {\r\n        for (var k in events) {\r\n            var p = events[k]\r\n            if (p) {\r\n                clearTimeout(events[k])\r\n                events[k] = null\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/action_controller.js","export default class GameInterface {\r\n    constructor() {\r\n        this.root = document.querySelector('#root')\r\n        this.game = document.querySelector('#game')\r\n        this.button = document.querySelector('#button')\r\n        this.curW = 440 // width of game interface\r\n        this.curH = 677 // height of game interface\r\n        this.aspectRatio = this.curW / this.curH\r\n        this.process = null\r\n    }\r\n\r\n    static new(...args) {\r\n        return new this(...args)\r\n    }\r\n\r\n    getBrowserInterfaceSize() {\r\n        var pageWidth = window.innerWidth;\r\n        var pageHeight = window.innerHeight;\r\n\r\n        if (typeof pageWidth != \"number\") {\r\n            //在标准模式下面\r\n            if (document.compatMode == \"CSS1Compat\" ) {\r\n                pageWidth = document.documentElement.clientWidth;\r\n                pageHeight = document.documentElement.clientHeight;\r\n            } else {\r\n                pageWidth = document.body.clientWidth;\r\n                pageHeight = window.body.clientHeight;\r\n            }\r\n        }\r\n    \r\n        return {\r\n            pageWidth: pageWidth,\r\n            pageHeight: pageHeight\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        var r, g, b, w, h, p, size, scale\r\n        r = this.root\r\n        g = this.game\r\n        b = this.button\r\n        p = this.getBrowserInterfaceSize()\r\n        w = p.pageWidth\r\n        h = p.pageHeight\r\n\r\n        // 根据浏览器可用高度调整游戏界面\r\n        if (h != this.curH) {\r\n            var negSize, nextW, leftOffset, topOffset\r\n            size = h / 677\r\n            negSize = size - 1\r\n            scale = `scale(${size})`\r\n            nextW = 440 * size // 浏览器 height 对应的游戏所需最大宽度\r\n\r\n            // 不需要调整界面部件大小的情况\r\n            if ((h < this.curH && nextW < this.curW) || // 正在缩小\r\n                (h > this.curH || nextW > this.curW)) { // 正在扩大\r\n                r.style.width = `${nextW}px`\r\n                this.curW = nextW\r\n\r\n                leftOffset = 220 * negSize\r\n                g.style.transform = `scale(${size})`\r\n                b.style.transform = `scale(${size})`\r\n                g.style.marginLeft = leftOffset + 50 + 'px'\r\n                b.style.marginLeft = leftOffset + 'px'\r\n            }\r\n\r\n            g.style.marginTop = 200 * negSize + 30 * size + 'px'\r\n            b.style.marginTop = 225 * negSize + 'px'\r\n\r\n            this.process = null            \r\n            this.curH = h\r\n        }\r\n\r\n        // 根据浏览器可用宽度调整游戏界面\r\n        if (w < this.curH * this.aspectRatio) {\r\n            r.style.width = '100%'\r\n\r\n            if (w == this.curW) {\r\n                return\r\n            }\r\n            \r\n            size = w / 440\r\n            negSize = size - 1\r\n            scale = `scale(${size})`\r\n\r\n            g.style.transform = b.style.transform = scale\r\n            g.style.marginLeft = `${220 * negSize + 50}px`\r\n            b.style.marginLeft = `${220 * negSize}px`\r\n            this.curW = w\r\n        } else {\r\n            r.style.width = `${h * this.aspectRatio}px`\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/game_interface.js"],"sourceRoot":""}